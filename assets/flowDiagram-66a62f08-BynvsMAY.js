import"./chakra-ui-DL3iEWi3.js";import{xO as e}from"./excalidraw-D5Q9WXro.js";import{a as t,c as n,i as r,l as i,n as a,o,r as s,s as c,t as l}from"./styles-c10674c1-CN7qswql.js";import"./react-markdown-CPDF2saO.js";import{C as u}from"./app-w2Jd5jCf.js";import{E as d,Mt as f,c as p,gt as m,j as h,m as g,v as _,vt as v,w as y,x as b,z as ee}from"./mermaid-b5860b54-BtaV6srn.js";import"./path-D481w0MF.js";import"./array-C5d_RYS0.js";import{t as x}from"./line-DXOMy9a7.js";import"./channel-gFWcY1o2.js";import"./_getTag-B_2LHer_.js";import{a as S,s as C,t as te}from"./graphlib-CE-n686m.js";import"./_baseIsEqual-Dvp7ABzP.js";import"./clone-Ci0bV0Kv.js";import"./createText-2e5e7dd3-DD66Z287.js";import"./edges-e0da2a9e-BDssmOYG.js";import{i as ne,n as w,o as T,r as re,t as ie}from"./dagre-ZPe2a3vH.js";import"./index-3862675e-C8wj6jNB.js";import{n as E,r as ae}from"./flowDb-956e92f1-BqvZFLB7.js";function oe(e){if(!e.ok)throw Error(e.status+` `+e.statusText);return e.text()}function se(e,t){return fetch(e,t).then(oe)}function ce(e){return(t,n)=>se(t,n).then(t=>new DOMParser().parseFromString(t,e))}var le=ce(`image/svg+xml`),D={normal:de,vee:fe,undirected:pe};function ue(e){D=e}function de(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function fe(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 L 4 5 z`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function pe(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 5 L 10 5`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function me(e,n){var r=e;return r.node().appendChild(n.label),t(r,n.labelStyle),r}function he(e,n){for(var r=e.append(`text`),i=ge(n.label).split(`
`),a=0;a<i.length;a++)r.append(`tspan`).attr(`xml:space`,`preserve`).attr(`dy`,`1em`).attr(`x`,`1`).text(i[a]);return t(r,n.labelStyle),r}function ge(e){for(var t=``,n=!1,r,i=0;i<e.length;++i)if(r=e[i],n){switch(r){case`n`:t+=`
`;break;default:t+=r}n=!1}else r===`\\`?n=!0:t+=r;return t}function O(e,t,n){var r=t.label,i=e.append(`g`);t.labelType===`svg`?me(i,t):typeof r!=`string`||t.labelType===`html`?s(i,t):he(i,t);var a=i.node().getBBox(),o;switch(n){case`top`:o=-t.height/2;break;case`bottom`:o=t.height/2-a.height;break;default:o=-a.height/2}return i.attr(`transform`,`translate(`+-a.width/2+`,`+o+`)`),i}var k=function(e,r){var i=r.nodes().filter(function(e){return n(r,e)}),a=e.selectAll(`g.cluster`).data(i,function(e){return e});o(a.exit(),r).style(`opacity`,0).remove();var s=a.enter().append(`g`).attr(`class`,`cluster`).attr(`id`,function(e){return r.node(e).id}).style(`opacity`,0).each(function(e){var t=r.node(e),n=u(this);u(this).append(`rect`),O(n.append(`g`).attr(`class`,`label`),t,t.clusterLabelPos)});return a=a.merge(s),a=o(a,r).style(`opacity`,1),a.selectAll(`rect`).each(function(e){var n=r.node(e);t(u(this),n.style)}),a};function _e(e){k=e}var A=function(e,t){var n=e.selectAll(`g.edgeLabel`).data(t.edges(),function(e){return c(e)}).classed(`update`,!0);return n.exit().remove(),n.enter().append(`g`).classed(`edgeLabel`,!0).style(`opacity`,0),n=e.selectAll(`g.edgeLabel`),n.each(function(e){var n=u(this);n.select(`.label`).remove();var r=t.edge(e),i=O(n,t.edge(e),0).classed(`label`,!0),a=i.node().getBBox();r.labelId&&i.attr(`id`,r.labelId),S(r,`width`)||(r.width=a.width),S(r,`height`)||(r.height=a.height)}),o(n.exit?n.exit():n.selectAll(null),t).style(`opacity`,0).remove(),n};function ve(e){A=e}function j(e,t){return e.intersect(t)}var M=function(e,n,i){var a=e.selectAll(`g.edgePath`).data(n.edges(),function(e){return c(e)}).classed(`update`,!0),s=Ce(a,n);we(a,n);var l=a.merge===void 0?a:a.merge(s);return o(l,n).style(`opacity`,1),l.each(function(e){var t=u(this),i=n.edge(e);i.elem=this,i.id&&t.attr(`id`,i.id),r(t,i.class,(t.classed(`update`)?`update `:``)+`edgePath`)}),l.selectAll(`path.path`).each(function(e){var r=n.edge(e);r.arrowheadId=w(`arrowhead`);var i=u(this).attr(`marker-end`,function(){return`url(`+be(location.href,r.arrowheadId)+`)`}).style(`fill`,`none`);o(i,n).attr(`d`,function(e){return xe(n,e)}),t(i,r.style)}),l.selectAll(`defs *`).remove(),l.selectAll(`defs`).each(function(e){var t=n.edge(e),r=i[t.arrowhead];r(u(this),t.arrowheadId,t,`arrowhead`)}),l};function ye(e){M=e}function be(e,t){return e.split(`#`)[0]+`#`+t}function xe(e,t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a=n.points.slice(1,n.points.length-1);return a.unshift(j(r,a[0])),a.push(j(i,a[a.length-1])),N(n,a)}function N(e,t){var n=(x||le.line)().x(function(e){return e.x}).y(function(e){return e.y});return(n.curve||n.interpolate)(e.curve),n(t)}function Se(e){var t=e.getBBox(),n=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(t.width/2,t.height/2);return{x:n.e,y:n.f}}function Ce(e,t){var n=e.enter().append(`g`).attr(`class`,`edgePath`).style(`opacity`,0);return n.append(`path`).attr(`class`,`path`).attr(`d`,function(e){var n=t.edge(e),r=t.node(e.v).elem;return N(n,re(n.points.length).map(function(){return Se(r)}))}),n.append(`defs`),n}function we(e,t){o(e.exit(),t).style(`opacity`,0).remove()}var P=function(e,i,a){var s=i.nodes().filter(function(e){return!n(i,e)}),c=e.selectAll(`g.node`).data(s,function(e){return e}).classed(`update`,!0);return c.exit().remove(),c.enter().append(`g`).attr(`class`,`node`).style(`opacity`,0),c=e.selectAll(`g.node`),c.each(function(e){var n=i.node(e),o=u(this);r(o,n.class,(o.classed(`update`)?`update `:``)+`node`),o.select(`g.label`).remove();var s=o.append(`g`).attr(`class`,`label`),c=O(s,n),l=a[n.shape],d=ne(c.node().getBBox(),`width`,`height`);n.elem=this,n.id&&o.attr(`id`,n.id),n.labelId&&s.attr(`id`,n.labelId),S(n,`width`)&&(d.width=n.width),S(n,`height`)&&(d.height=n.height),d.width+=n.paddingLeft+n.paddingRight,d.height+=n.paddingTop+n.paddingBottom,s.attr(`transform`,`translate(`+(n.paddingLeft-n.paddingRight)/2+`,`+(n.paddingTop-n.paddingBottom)/2+`)`);var f=u(this);f.select(`.label-container`).remove();var p=l(f,d,n).classed(`label-container`,!0);t(p,n.style);var m=p.node().getBBox();n.width=m.width,n.height=m.height}),o(c.exit?c.exit():c.selectAll(null),i).style(`opacity`,0).remove(),c};function Te(e){P=e}function Ee(e,t){var n=e.filter(function(){return!u(this).classed(`update`)});function r(e){var n=t.node(e);return`translate(`+n.x+`,`+n.y+`)`}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r),o(n.selectAll(`rect`),t).attr(`width`,function(e){return t.node(e).width}).attr(`height`,function(e){return t.node(e).height}).attr(`x`,function(e){return-t.node(e).width/2}).attr(`y`,function(e){return-t.node(e).height/2})}function De(e,t){var n=e.filter(function(){return!u(this).classed(`update`)});function r(e){var n=t.edge(e);return S(n,`x`)?`translate(`+n.x+`,`+n.y+`)`:``}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r)}function Oe(e,t){var n=e.filter(function(){return!u(this).classed(`update`)});function r(e){var n=t.node(e);return`translate(`+n.x+`,`+n.y+`)`}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r)}function F(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}function ke(e,t,n){return F(e,t,t,n)}function Ae(e,t,n,r){var i=t.y-e.y,a,o=e.x-t.x,s,c=t.x*e.y-e.x*t.y,l,u,d,f=i*n.x+o*n.y+c,p=i*r.x+o*r.y+c,m,h,g,_,v;if(!(f!==0&&p!==0&&I(f,p))&&(a=r.y-n.y,s=n.x-r.x,l=r.x*n.y-n.x*r.y,u=a*e.x+s*e.y+l,d=a*t.x+s*t.y+l,!(u!==0&&d!==0&&I(u,d))&&(m=i*s-a*o,m!==0)))return h=Math.abs(m/2),g=o*l-s*c,_=g<0?(g-h)/m:(g+h)/m,g=a*c-i*l,v=g<0?(g-h)/m:(g+h)/m,{x:_,y:v}}function I(e,t){return e*t>0}function L(e,t,n){var r=e.x,i=e.y,a=[],o=1/0,s=1/0;t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)});for(var c=r-e.width/2-o,l=i-e.height/2-s,u=0;u<t.length;u++){var d=t[u],f=t[u<t.length-1?u+1:0],p=Ae(e,n,{x:c+d.x,y:l+d.y},{x:c+f.x,y:l+f.y});p&&a.push(p)}return a.length?(a.length>1&&a.sort(function(e,t){var r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):(console.log(`NO INTERSECTION FOUND, RETURN NODE CENTER`,e),e)}function R(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}}var z={rect:Me,ellipse:Ne,circle:Pe,diamond:Fe};function je(e){z=e}function Me(e,t,n){var r=e.insert(`rect`,`:first-child`).attr(`rx`,n.rx).attr(`ry`,n.ry).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`width`,t.width).attr(`height`,t.height);return n.intersect=function(e){return R(n,e)},r}function Ne(e,t,n){var r=t.width/2,i=t.height/2,a=e.insert(`ellipse`,`:first-child`).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`rx`,r).attr(`ry`,i);return n.intersect=function(e){return F(n,r,i,e)},a}function Pe(e,t,n){var r=Math.max(t.width,t.height)/2,i=e.insert(`circle`,`:first-child`).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`r`,r);return n.intersect=function(e){return ke(n,r,e)},i}function Fe(e,t,n){var r=t.width*Math.SQRT2/2,i=t.height*Math.SQRT2/2,a=[{x:0,y:-i},{x:-r,y:0},{x:0,y:i},{x:r,y:0}],o=e.insert(`polygon`,`:first-child`).attr(`points`,a.map(function(e){return e.x+`,`+e.y}).join(` `));return n.intersect=function(e){return L(n,a,e)},o}function Ie(){var e=function(e,t){ze(t);var n=B(e,`output`),r=B(n,`clusters`),i=B(n,`edgePaths`),a=A(B(n,`edgeLabels`),t),o=P(B(n,`nodes`),t,z);ie(t),Oe(o,t),De(a,t),M(i,t,D),Ee(k(r,t),t),Be(t)};return e.createNodes=function(t){return arguments.length?(Te(t),e):P},e.createClusters=function(t){return arguments.length?(_e(t),e):k},e.createEdgeLabels=function(t){return arguments.length?(ve(t),e):A},e.createEdgePaths=function(t){return arguments.length?(ye(t),e):M},e.shapes=function(t){return arguments.length?(je(t),e):z},e.arrows=function(t){return arguments.length?(ue(t),e):D},e}var Le={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:`rect`},Re={arrowhead:`normal`,curve:v};function ze(e){e.nodes().forEach(function(t){var n=e.node(t);!S(n,`label`)&&!e.children(t).length&&(n.label=t),S(n,`paddingX`)&&T(n,{paddingLeft:n.paddingX,paddingRight:n.paddingX}),S(n,`paddingY`)&&T(n,{paddingTop:n.paddingY,paddingBottom:n.paddingY}),S(n,`padding`)&&T(n,{paddingLeft:n.padding,paddingRight:n.padding,paddingTop:n.padding,paddingBottom:n.padding}),T(n,Le),C([`paddingLeft`,`paddingRight`,`paddingTop`,`paddingBottom`],function(e){n[e]=Number(n[e])}),S(n,`width`)&&(n._prevWidth=n.width),S(n,`height`)&&(n._prevHeight=n.height)}),e.edges().forEach(function(t){var n=e.edge(t);S(n,`label`)||(n.label=``),T(n,Re)})}function Be(e){C(e.nodes(),function(t){var n=e.node(t);S(n,`_prevWidth`)?n.width=n._prevWidth:delete n.width,S(n,`_prevHeight`)?n.height=n._prevHeight:delete n.height,delete n._prevWidth,delete n._prevHeight})}function B(e,t){var n=e.select(`g.`+t);return n.empty()&&(n=e.append(`g`).attr(`class`,t)),n}f(),e(),m();function V(e,t,n){let r=(t.width+t.height)*.9,i=[{x:r/2,y:0},{x:r,y:-r/2},{x:r/2,y:-r},{x:0,y:-r/2}],a=Q(e,r,r,i);return n.intersect=function(e){return L(n,i,e)},a}function H(e,t,n){let r=t.height,i=r/4,a=t.width+2*i,o=[{x:i,y:0},{x:a-i,y:0},{x:a,y:-r/2},{x:a-i,y:-r},{x:i,y:-r},{x:0,y:-r/2}],s=Q(e,a,r,o);return n.intersect=function(e){return L(n,o,e)},s}function U(e,t,n){let r=t.width,i=t.height,a=[{x:-i/2,y:0},{x:r,y:0},{x:r,y:-i},{x:-i/2,y:-i},{x:0,y:-i/2}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function W(e,t,n){let r=t.width,i=t.height,a=[{x:-2*i/6,y:0},{x:r-i/6,y:0},{x:r+2*i/6,y:-i},{x:i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function G(e,t,n){let r=t.width,i=t.height,a=[{x:2*i/6,y:0},{x:r+i/6,y:0},{x:r-2*i/6,y:-i},{x:-i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function K(e,t,n){let r=t.width,i=t.height,a=[{x:-2*i/6,y:0},{x:r+2*i/6,y:0},{x:r-i/6,y:-i},{x:i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function q(e,t,n){let r=t.width,i=t.height,a=[{x:i/6,y:0},{x:r-i/6,y:0},{x:r+2*i/6,y:-i},{x:-2*i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function J(e,t,n){let r=t.width,i=t.height,a=[{x:0,y:0},{x:r+i/2,y:0},{x:r,y:-i/2},{x:r+i/2,y:-i},{x:0,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function Y(e,t,n){let r=t.height,i=t.width+r/4,a=e.insert(`rect`,`:first-child`).attr(`rx`,r/2).attr(`ry`,r/2).attr(`x`,-i/2).attr(`y`,-r/2).attr(`width`,i).attr(`height`,r);return n.intersect=function(e){return R(n,e)},a}function X(e,t,n){let r=t.width,i=t.height,a=[{x:0,y:0},{x:r,y:0},{x:r,y:-i},{x:0,y:-i},{x:0,y:0},{x:-8,y:0},{x:r+8,y:0},{x:r+8,y:-i},{x:-8,y:-i},{x:-8,y:0}],o=Q(e,r,i,a);return n.intersect=function(e){return L(n,a,e)},o}function Z(e,t,n){let r=t.width,i=r/2,a=i/(2.5+r/50),o=t.height+a,s=`M 0,`+a+` a `+i+`,`+a+` 0,0,0 `+r+` 0 a `+i+`,`+a+` 0,0,0 `+-r+` 0 l 0,`+o+` a `+i+`,`+a+` 0,0,0 `+r+` 0 l 0,`+-o,c=e.attr(`label-offset-y`,a).insert(`path`,`:first-child`).attr(`d`,s).attr(`transform`,`translate(`+-r/2+`,`+-(o/2+a)+`)`);return n.intersect=function(e){let t=R(n,e),r=t.x-n.x;if(i!=0&&(Math.abs(r)<n.width/2||Math.abs(r)==n.width/2&&Math.abs(t.y-n.y)>n.height/2-a)){let o=a*a*(1-r*r/(i*i));o!=0&&(o=Math.sqrt(o)),o=a-o,e.y-n.y>0&&(o=-o),t.y+=o}return t},c}function Ve(e){e.shapes().question=V,e.shapes().hexagon=H,e.shapes().stadium=Y,e.shapes().subroutine=X,e.shapes().cylinder=Z,e.shapes().rect_left_inv_arrow=U,e.shapes().lean_right=W,e.shapes().lean_left=G,e.shapes().trapezoid=K,e.shapes().inv_trapezoid=q,e.shapes().rect_right_inv_arrow=J}function He(e){e({question:V}),e({hexagon:H}),e({stadium:Y}),e({subroutine:X}),e({cylinder:Z}),e({rect_left_inv_arrow:U}),e({lean_right:W}),e({lean_left:G}),e({trapezoid:K}),e({inv_trapezoid:q}),e({rect_right_inv_arrow:J})}function Q(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}var Ue={addToRender:Ve,addToRenderV2:He},We={},Ge=function(e){let t=Object.keys(e);for(let n of t)We[n]=e[n]},Ke=async function(e,t,n,r,i,a){let o=r?r.select(`[id="${n}"]`):u(`[id="${n}"]`),c=i||document,l=Object.keys(e);for(let n of l){let r=e[n],i=`default`;r.classes.length>0&&(i=r.classes.join(` `));let l=b(r.styles),u=r.text===void 0?r.id:r.text,f;if(g(_().flowchart.htmlLabels))f=s(o,{label:await h(u.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),_())}).node(),f.parentNode.removeChild(f);else{let e=c.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,l.labelStyle.replace(`color:`,`fill:`));let t=u.split(p.lineBreakRegex);for(let n of t){let t=c.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);t.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),t.setAttribute(`dy`,`1em`),t.setAttribute(`x`,`1`),t.textContent=n,e.appendChild(t)}f=e}let m=0,v=``;switch(r.type){case`round`:m=5,v=`rect`;break;case`square`:v=`rect`;break;case`diamond`:v=`question`;break;case`hexagon`:v=`hexagon`;break;case`odd`:v=`rect_left_inv_arrow`;break;case`lean_right`:v=`lean_right`;break;case`lean_left`:v=`lean_left`;break;case`trapezoid`:v=`trapezoid`;break;case`inv_trapezoid`:v=`inv_trapezoid`;break;case`odd_right`:v=`rect_left_inv_arrow`;break;case`circle`:v=`circle`;break;case`ellipse`:v=`ellipse`;break;case`stadium`:v=`stadium`;break;case`subroutine`:v=`subroutine`;break;case`cylinder`:v=`cylinder`;break;case`group`:v=`rect`;break;default:v=`rect`}d.warn(`Adding node`,r.id,r.domId),t.setNode(a.db.lookUpDomId(r.id),{labelType:`svg`,labelStyle:l.labelStyle,shape:v,label:f,rx:m,ry:m,class:i,style:l.style,id:a.db.lookUpDomId(r.id)})}},$=async function(e,t,n){let r=0,i,a;if(e.defaultStyle!==void 0){let t=b(e.defaultStyle);i=t.style,a=t.labelStyle}for(let o of e){r++;let s=`L-`+o.start+`-`+o.end,c=`LS-`+o.start,l=`LE-`+o.end,u={};o.type===`arrow_open`?u.arrowhead=`none`:u.arrowhead=`normal`;let d=``,f=``;if(o.style!==void 0){let e=b(o.style);d=e.style,f=e.labelStyle}else switch(o.stroke){case`normal`:d=`fill:none`,i!==void 0&&(d=i),a!==void 0&&(f=a);break;case`dotted`:d=`fill:none;stroke-width:2px;stroke-dasharray:3;`;break;case`thick`:d=` stroke-width: 3.5px;fill:none`;break}u.style=d,u.labelStyle=f,o.interpolate===void 0?e.defaultInterpolate===void 0?u.curve=y(We.curve,v):u.curve=y(e.defaultInterpolate,v):u.curve=y(o.interpolate,v),o.text===void 0?o.style!==void 0&&(u.arrowheadStyle=`fill: #333`):(u.arrowheadStyle=`fill: #333`,u.labelpos=`c`,g(_().flowchart.htmlLabels)?(u.labelType=`html`,u.label=`<span id="L-${s}" class="edgeLabel L-${c}' L-${l}" style="${u.labelStyle}">${await h(o.text.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),_())}</span>`):(u.labelType=`text`,u.label=o.text.replace(p.lineBreakRegex,`
`),o.style===void 0&&(u.style=u.style||`stroke: #333; stroke-width: 1.5px;fill:none`),u.labelStyle=u.labelStyle.replace(`color:`,`fill:`))),u.id=s,u.class=c+` `+l,u.minlen=o.length||1,t.setEdge(n.db.lookUpDomId(o.start),n.db.lookUpDomId(o.end),u,r)}},qe={setConf:Ge,addVertices:Ke,addEdges:$,getClasses:function(e,t){return d.info(`Extracting classes`),t.db.getClasses()},draw:async function(e,n,r,a){d.info(`Drawing flowchart`);let{securityLevel:o,flowchart:s}=_(),c;o===`sandbox`&&(c=u(`#i`+n));let l=u(o===`sandbox`?c.nodes()[0].contentDocument.body:`body`),f=o===`sandbox`?c.nodes()[0].contentDocument:document,p=a.db.getDirection();p===void 0&&(p=`TD`);let m=s.nodeSpacing||50,h=s.rankSpacing||50,g=new te({multigraph:!0,compound:!0}).setGraph({rankdir:p,nodesep:m,ranksep:h,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),v,y=a.db.getSubGraphs();for(let e=y.length-1;e>=0;e--)v=y[e],a.db.addVertex(v.id,v.title,`group`,void 0,v.classes);let b=a.db.getVertices();d.warn(`Get vertices`,b);let x=a.db.getEdges(),S=0;for(S=y.length-1;S>=0;S--){v=y[S],i(`cluster`).append(`text`);for(let e=0;e<v.nodes.length;e++)d.warn(`Setting subgraph`,v.nodes[e],a.db.lookUpDomId(v.nodes[e]),a.db.lookUpDomId(v.id)),g.setParent(a.db.lookUpDomId(v.nodes[e]),a.db.lookUpDomId(v.id))}await Ke(b,g,n,l,f,a),await $(x,g,a);let C=new Ie;Ue.addToRender(C),C.arrows().none=function(e,n,r,i){t(e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 0 0 L 0 0 z`),r[i+`Style`])},C.arrows().normal=function(e,t){e.append(`marker`).attr(`id`,t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).attr(`class`,`arrowheadPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)};let ne=l.select(`[id="${n}"]`),w=l.select(`#`+n+` g`);for(C(w,g),w.selectAll(`g.node`).attr(`title`,function(){return a.db.getTooltip(this.id)}),a.db.indexNodes(`subGraph`+S),S=0;S<y.length;S++)if(v=y[S],v.title!==`undefined`){let e=f.querySelectorAll(`#`+n+` [id="`+a.db.lookUpDomId(v.id)+`"] rect`),t=f.querySelectorAll(`#`+n+` [id="`+a.db.lookUpDomId(v.id)+`"]`),r=e[0].x.baseVal.value,i=e[0].y.baseVal.value,o=e[0].width.baseVal.value,s=u(t[0]).select(`.label`);s.attr(`transform`,`translate(${r+o/2}, ${i+14})`),s.attr(`id`,n+`Text`);for(let e=0;e<v.classes.length;e++)t[0].classList.add(v.classes[e])}if(!s.htmlLabels){let e=f.querySelectorAll(`[id="`+n+`"] .edgeLabel .label`);for(let t of e){let e=t.getBBox(),n=f.createElementNS(`http://www.w3.org/2000/svg`,`rect`);n.setAttribute(`rx`,0),n.setAttribute(`ry`,0),n.setAttribute(`width`,e.width),n.setAttribute(`height`,e.height),t.insertBefore(n,t.firstChild)}}ee(g,ne,s.diagramPadding,s.useMaxWidth),Object.keys(b).forEach(function(e){let t=b[e];if(t.link){let r=l.select(`#`+n+` [id="`+a.db.lookUpDomId(e)+`"]`);if(r){let e=f.createElementNS(`http://www.w3.org/2000/svg`,`a`);e.setAttributeNS(`http://www.w3.org/2000/svg`,`class`,t.classes.join(` `)),e.setAttributeNS(`http://www.w3.org/2000/svg`,`href`,t.link),e.setAttributeNS(`http://www.w3.org/2000/svg`,`rel`,`noopener`),o===`sandbox`?e.setAttributeNS(`http://www.w3.org/2000/svg`,`target`,`_top`):t.linkTarget&&e.setAttributeNS(`http://www.w3.org/2000/svg`,`target`,t.linkTarget);let n=r.insert(function(){return e},`:first-child`),i=r.select(`.label-container`);i&&n.append(function(){return i.node()});let a=r.select(`.label`);a&&n.append(function(){return a.node()})}}})}},Je={parser:ae,db:E,renderer:l,styles:a,init:e=>{e.flowchart||={},e.flowchart.arrowMarkerAbsolute=e.arrowMarkerAbsolute,qe.setConf(e.flowchart),E.clear(),E.setGen(`gen-1`)}};export{Je as diagram};