import"./chakra-ui-DL3iEWi3.js";import{xO as e}from"./excalidraw-1VskLdYQ.js";import{a as t,c as n,i as r,l as i,n as a,o,r as s,s as c,t as l}from"./styles-c10674c1-CpdnBf-j.js";import{a as u,s as d,t as f}from"./graphlib-C4rS00Ae.js";import{i as p,n as m,o as h,r as g,t as _}from"./dagre-DdUdckMd.js";import{E as v,J as y,X as b,c as x,j as S,m as C,ut as w,v as T,w as E,x as D,z as ee}from"./mermaid-b5860b54-BF_2ynSb.js";import"./clone-Dz6IUMUN.js";import"./react-markdown-Dc1ste6M.js";import{it as O}from"./app-C41Pz19o.js";import"./path-CZHMXrTW.js";import"./array-DZBJPEBo.js";import{t as te}from"./line-B-kSiyBz.js";import"./channel-_el1px5N.js";import"./createText-2e5e7dd3-Bdd3vVYp.js";import"./edges-e0da2a9e-BdBCbmqC.js";import"./index-3862675e-BI5yGzQA.js";import{n as k,r as ne}from"./flowDb-956e92f1-LRP80rWM.js";function re(e){if(!e.ok)throw Error(e.status+` `+e.statusText);return e.text()}function ie(e,t){return fetch(e,t).then(re)}function ae(e){return(t,n)=>ie(t,n).then(t=>new DOMParser().parseFromString(t,e))}var oe=ae(`image/svg+xml`),A={normal:ce,vee:le,undirected:ue};function se(e){A=e}function ce(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function le(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 L 4 5 z`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function ue(e,n,r,i){var a=e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 5 L 10 5`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`);t(a,r[i+`Style`]),r[i+`Class`]&&a.attr(`class`,r[i+`Class`])}function de(e,n){var r=e;return r.node().appendChild(n.label),t(r,n.labelStyle),r}function fe(e,n){for(var r=e.append(`text`),i=pe(n.label).split(`
`),a=0;a<i.length;a++)r.append(`tspan`).attr(`xml:space`,`preserve`).attr(`dy`,`1em`).attr(`x`,`1`).text(i[a]);return t(r,n.labelStyle),r}function pe(e){for(var t=``,n=!1,r,i=0;i<e.length;++i)if(r=e[i],n){switch(r){case`n`:t+=`
`;break;default:t+=r}n=!1}else r===`\\`?n=!0:t+=r;return t}function j(e,t,n){var r=t.label,i=e.append(`g`);t.labelType===`svg`?de(i,t):typeof r!=`string`||t.labelType===`html`?s(i,t):fe(i,t);var a=i.node().getBBox(),o;switch(n){case`top`:o=-t.height/2;break;case`bottom`:o=t.height/2-a.height;break;default:o=-a.height/2}return i.attr(`transform`,`translate(`+-a.width/2+`,`+o+`)`),i}var M=function(e,r){var i=r.nodes().filter(function(e){return n(r,e)}),a=e.selectAll(`g.cluster`).data(i,function(e){return e});o(a.exit(),r).style(`opacity`,0).remove();var s=a.enter().append(`g`).attr(`class`,`cluster`).attr(`id`,function(e){return r.node(e).id}).style(`opacity`,0).each(function(e){var t=r.node(e),n=O(this);O(this).append(`rect`),j(n.append(`g`).attr(`class`,`label`),t,t.clusterLabelPos)});return a=a.merge(s),a=o(a,r).style(`opacity`,1),a.selectAll(`rect`).each(function(e){var n=r.node(e);t(O(this),n.style)}),a};function me(e){M=e}var N=function(e,t){var n=e.selectAll(`g.edgeLabel`).data(t.edges(),function(e){return c(e)}).classed(`update`,!0);return n.exit().remove(),n.enter().append(`g`).classed(`edgeLabel`,!0).style(`opacity`,0),n=e.selectAll(`g.edgeLabel`),n.each(function(e){var n=O(this);n.select(`.label`).remove();var r=t.edge(e),i=j(n,t.edge(e),0).classed(`label`,!0),a=i.node().getBBox();r.labelId&&i.attr(`id`,r.labelId),u(r,`width`)||(r.width=a.width),u(r,`height`)||(r.height=a.height)}),o(n.exit?n.exit():n.selectAll(null),t).style(`opacity`,0).remove(),n};function he(e){N=e}function P(e,t){return e.intersect(t)}var F=function(e,n,i){var a=e.selectAll(`g.edgePath`).data(n.edges(),function(e){return c(e)}).classed(`update`,!0),s=be(a,n);xe(a,n);var l=a.merge===void 0?a:a.merge(s);return o(l,n).style(`opacity`,1),l.each(function(e){var t=O(this),i=n.edge(e);i.elem=this,i.id&&t.attr(`id`,i.id),r(t,i.class,(t.classed(`update`)?`update `:``)+`edgePath`)}),l.selectAll(`path.path`).each(function(e){var r=n.edge(e);r.arrowheadId=m(`arrowhead`);var i=O(this).attr(`marker-end`,function(){return`url(`+_e(location.href,r.arrowheadId)+`)`}).style(`fill`,`none`);o(i,n).attr(`d`,function(e){return ve(n,e)}),t(i,r.style)}),l.selectAll(`defs *`).remove(),l.selectAll(`defs`).each(function(e){var t=n.edge(e),r=i[t.arrowhead];r(O(this),t.arrowheadId,t,`arrowhead`)}),l};function ge(e){F=e}function _e(e,t){return e.split(`#`)[0]+`#`+t}function ve(e,t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a=n.points.slice(1,n.points.length-1);return a.unshift(P(r,a[0])),a.push(P(i,a[a.length-1])),I(n,a)}function I(e,t){var n=(te||oe.line)().x(function(e){return e.x}).y(function(e){return e.y});return(n.curve||n.interpolate)(e.curve),n(t)}function ye(e){var t=e.getBBox(),n=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(t.width/2,t.height/2);return{x:n.e,y:n.f}}function be(e,t){var n=e.enter().append(`g`).attr(`class`,`edgePath`).style(`opacity`,0);return n.append(`path`).attr(`class`,`path`).attr(`d`,function(e){var n=t.edge(e),r=t.node(e.v).elem;return I(n,g(n.points.length).map(function(){return ye(r)}))}),n.append(`defs`),n}function xe(e,t){o(e.exit(),t).style(`opacity`,0).remove()}var L=function(e,i,a){var s=i.nodes().filter(function(e){return!n(i,e)}),c=e.selectAll(`g.node`).data(s,function(e){return e}).classed(`update`,!0);return c.exit().remove(),c.enter().append(`g`).attr(`class`,`node`).style(`opacity`,0),c=e.selectAll(`g.node`),c.each(function(e){var n=i.node(e),o=O(this);r(o,n.class,(o.classed(`update`)?`update `:``)+`node`),o.select(`g.label`).remove();var s=o.append(`g`).attr(`class`,`label`),c=j(s,n),l=a[n.shape],d=p(c.node().getBBox(),`width`,`height`);n.elem=this,n.id&&o.attr(`id`,n.id),n.labelId&&s.attr(`id`,n.labelId),u(n,`width`)&&(d.width=n.width),u(n,`height`)&&(d.height=n.height),d.width+=n.paddingLeft+n.paddingRight,d.height+=n.paddingTop+n.paddingBottom,s.attr(`transform`,`translate(`+(n.paddingLeft-n.paddingRight)/2+`,`+(n.paddingTop-n.paddingBottom)/2+`)`);var f=O(this);f.select(`.label-container`).remove();var m=l(f,d,n).classed(`label-container`,!0);t(m,n.style);var h=m.node().getBBox();n.width=h.width,n.height=h.height}),o(c.exit?c.exit():c.selectAll(null),i).style(`opacity`,0).remove(),c};function Se(e){L=e}function Ce(e,t){var n=e.filter(function(){return!O(this).classed(`update`)});function r(e){var n=t.node(e);return`translate(`+n.x+`,`+n.y+`)`}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r),o(n.selectAll(`rect`),t).attr(`width`,function(e){return t.node(e).width}).attr(`height`,function(e){return t.node(e).height}).attr(`x`,function(e){return-t.node(e).width/2}).attr(`y`,function(e){return-t.node(e).height/2})}function we(e,t){var n=e.filter(function(){return!O(this).classed(`update`)});function r(e){var n=t.edge(e);return u(n,`x`)?`translate(`+n.x+`,`+n.y+`)`:``}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r)}function Te(e,t){var n=e.filter(function(){return!O(this).classed(`update`)});function r(e){var n=t.node(e);return`translate(`+n.x+`,`+n.y+`)`}n.attr(`transform`,r),o(e,t).style(`opacity`,1).attr(`transform`,r)}function R(e,t,n,r){var i=e.x,a=e.y,o=i-r.x,s=a-r.y,c=Math.sqrt(t*t*s*s+n*n*o*o),l=Math.abs(t*n*o/c);r.x<i&&(l=-l);var u=Math.abs(t*n*s/c);return r.y<a&&(u=-u),{x:i+l,y:a+u}}function Ee(e,t,n){return R(e,t,t,n)}function De(e,t,n,r){var i=t.y-e.y,a,o=e.x-t.x,s,c=t.x*e.y-e.x*t.y,l,u,d,f=i*n.x+o*n.y+c,p=i*r.x+o*r.y+c,m,h,g,_,v;if(!(f!==0&&p!==0&&z(f,p))&&(a=r.y-n.y,s=n.x-r.x,l=r.x*n.y-n.x*r.y,u=a*e.x+s*e.y+l,d=a*t.x+s*t.y+l,!(u!==0&&d!==0&&z(u,d))&&(m=i*s-a*o,m!==0)))return h=Math.abs(m/2),g=o*l-s*c,_=g<0?(g-h)/m:(g+h)/m,g=a*c-i*l,v=g<0?(g-h)/m:(g+h)/m,{x:_,y:v}}function z(e,t){return e*t>0}function B(e,t,n){var r=e.x,i=e.y,a=[],o=1/0,s=1/0;t.forEach(function(e){o=Math.min(o,e.x),s=Math.min(s,e.y)});for(var c=r-e.width/2-o,l=i-e.height/2-s,u=0;u<t.length;u++){var d=t[u],f=t[u<t.length-1?u+1:0],p=De(e,n,{x:c+d.x,y:l+d.y},{x:c+f.x,y:l+f.y});p&&a.push(p)}return a.length?(a.length>1&&a.sort(function(e,t){var r=e.x-n.x,i=e.y-n.y,a=Math.sqrt(r*r+i*i),o=t.x-n.x,s=t.y-n.y,c=Math.sqrt(o*o+s*s);return a<c?-1:a===c?0:1}),a[0]):(console.log(`NO INTERSECTION FOUND, RETURN NODE CENTER`,e),e)}function V(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2,c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=a===0?0:s*i/a,l=s):(i<0&&(o=-o),c=o,l=i===0?0:o*a/i),{x:n+c,y:r+l}}var H={rect:ke,ellipse:Ae,circle:je,diamond:Me};function Oe(e){H=e}function ke(e,t,n){var r=e.insert(`rect`,`:first-child`).attr(`rx`,n.rx).attr(`ry`,n.ry).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`width`,t.width).attr(`height`,t.height);return n.intersect=function(e){return V(n,e)},r}function Ae(e,t,n){var r=t.width/2,i=t.height/2,a=e.insert(`ellipse`,`:first-child`).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`rx`,r).attr(`ry`,i);return n.intersect=function(e){return R(n,r,i,e)},a}function je(e,t,n){var r=Math.max(t.width,t.height)/2,i=e.insert(`circle`,`:first-child`).attr(`x`,-t.width/2).attr(`y`,-t.height/2).attr(`r`,r);return n.intersect=function(e){return Ee(n,r,e)},i}function Me(e,t,n){var r=t.width*Math.SQRT2/2,i=t.height*Math.SQRT2/2,a=[{x:0,y:-i},{x:-r,y:0},{x:0,y:i},{x:r,y:0}],o=e.insert(`polygon`,`:first-child`).attr(`points`,a.map(function(e){return e.x+`,`+e.y}).join(` `));return n.intersect=function(e){return B(n,a,e)},o}function Ne(){var e=function(e,t){Ie(t);var n=U(e,`output`),r=U(n,`clusters`),i=U(n,`edgePaths`),a=N(U(n,`edgeLabels`),t),o=L(U(n,`nodes`),t,H);_(t),Te(o,t),we(a,t),F(i,t,A),Ce(M(r,t),t),Le(t)};return e.createNodes=function(t){return arguments.length?(Se(t),e):L},e.createClusters=function(t){return arguments.length?(me(t),e):M},e.createEdgeLabels=function(t){return arguments.length?(he(t),e):N},e.createEdgePaths=function(t){return arguments.length?(ge(t),e):F},e.shapes=function(t){return arguments.length?(Oe(t),e):H},e.arrows=function(t){return arguments.length?(se(t),e):A},e}var Pe={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:`rect`},Fe={arrowhead:`normal`,curve:b};function Ie(e){e.nodes().forEach(function(t){var n=e.node(t);!u(n,`label`)&&!e.children(t).length&&(n.label=t),u(n,`paddingX`)&&h(n,{paddingLeft:n.paddingX,paddingRight:n.paddingX}),u(n,`paddingY`)&&h(n,{paddingTop:n.paddingY,paddingBottom:n.paddingY}),u(n,`padding`)&&h(n,{paddingLeft:n.padding,paddingRight:n.padding,paddingTop:n.padding,paddingBottom:n.padding}),h(n,Pe),d([`paddingLeft`,`paddingRight`,`paddingTop`,`paddingBottom`],function(e){n[e]=Number(n[e])}),u(n,`width`)&&(n._prevWidth=n.width),u(n,`height`)&&(n._prevHeight=n.height)}),e.edges().forEach(function(t){var n=e.edge(t);u(n,`label`)||(n.label=``),h(n,Fe)})}function Le(e){d(e.nodes(),function(t){var n=e.node(t);u(n,`_prevWidth`)?n.width=n._prevWidth:delete n.width,u(n,`_prevHeight`)?n.height=n._prevHeight:delete n.height,delete n._prevWidth,delete n._prevHeight})}function U(e,t){var n=e.select(`g.`+t);return n.empty()&&(n=e.append(`g`).attr(`class`,t)),n}w(),e(),y();function W(e,t,n){let r=(t.width+t.height)*.9,i=[{x:r/2,y:0},{x:r,y:-r/2},{x:r/2,y:-r},{x:0,y:-r/2}],a=Q(e,r,r,i);return n.intersect=function(e){return B(n,i,e)},a}function G(e,t,n){let r=t.height,i=r/4,a=t.width+2*i,o=[{x:i,y:0},{x:a-i,y:0},{x:a,y:-r/2},{x:a-i,y:-r},{x:i,y:-r},{x:0,y:-r/2}],s=Q(e,a,r,o);return n.intersect=function(e){return B(n,o,e)},s}function K(e,t,n){let r=t.width,i=t.height,a=[{x:-i/2,y:0},{x:r,y:0},{x:r,y:-i},{x:-i/2,y:-i},{x:0,y:-i/2}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function q(e,t,n){let r=t.width,i=t.height,a=[{x:-2*i/6,y:0},{x:r-i/6,y:0},{x:r+2*i/6,y:-i},{x:i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function J(e,t,n){let r=t.width,i=t.height,a=[{x:2*i/6,y:0},{x:r+i/6,y:0},{x:r-2*i/6,y:-i},{x:-i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function Y(e,t,n){let r=t.width,i=t.height,a=[{x:-2*i/6,y:0},{x:r+2*i/6,y:0},{x:r-i/6,y:-i},{x:i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function X(e,t,n){let r=t.width,i=t.height,a=[{x:i/6,y:0},{x:r-i/6,y:0},{x:r+2*i/6,y:-i},{x:-2*i/6,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function Z(e,t,n){let r=t.width,i=t.height,a=[{x:0,y:0},{x:r+i/2,y:0},{x:r,y:-i/2},{x:r+i/2,y:-i},{x:0,y:-i}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function Re(e,t,n){let r=t.height,i=t.width+r/4,a=e.insert(`rect`,`:first-child`).attr(`rx`,r/2).attr(`ry`,r/2).attr(`x`,-i/2).attr(`y`,-r/2).attr(`width`,i).attr(`height`,r);return n.intersect=function(e){return V(n,e)},a}function ze(e,t,n){let r=t.width,i=t.height,a=[{x:0,y:0},{x:r,y:0},{x:r,y:-i},{x:0,y:-i},{x:0,y:0},{x:-8,y:0},{x:r+8,y:0},{x:r+8,y:-i},{x:-8,y:-i},{x:-8,y:0}],o=Q(e,r,i,a);return n.intersect=function(e){return B(n,a,e)},o}function Be(e,t,n){let r=t.width,i=r/2,a=i/(2.5+r/50),o=t.height+a,s=`M 0,`+a+` a `+i+`,`+a+` 0,0,0 `+r+` 0 a `+i+`,`+a+` 0,0,0 `+-r+` 0 l 0,`+o+` a `+i+`,`+a+` 0,0,0 `+r+` 0 l 0,`+-o,c=e.attr(`label-offset-y`,a).insert(`path`,`:first-child`).attr(`d`,s).attr(`transform`,`translate(`+-r/2+`,`+-(o/2+a)+`)`);return n.intersect=function(e){let t=V(n,e),r=t.x-n.x;if(i!=0&&(Math.abs(r)<n.width/2||Math.abs(r)==n.width/2&&Math.abs(t.y-n.y)>n.height/2-a)){let o=a*a*(1-r*r/(i*i));o!=0&&(o=Math.sqrt(o)),o=a-o,e.y-n.y>0&&(o=-o),t.y+=o}return t},c}function Ve(e){e.shapes().question=W,e.shapes().hexagon=G,e.shapes().stadium=Re,e.shapes().subroutine=ze,e.shapes().cylinder=Be,e.shapes().rect_left_inv_arrow=K,e.shapes().lean_right=q,e.shapes().lean_left=J,e.shapes().trapezoid=Y,e.shapes().inv_trapezoid=X,e.shapes().rect_right_inv_arrow=Z}function He(e){e({question:W}),e({hexagon:G}),e({stadium:Re}),e({subroutine:ze}),e({cylinder:Be}),e({rect_left_inv_arrow:K}),e({lean_right:q}),e({lean_left:J}),e({trapezoid:Y}),e({inv_trapezoid:X}),e({rect_right_inv_arrow:Z})}function Q(e,t,n,r){return e.insert(`polygon`,`:first-child`).attr(`points`,r.map(function(e){return e.x+`,`+e.y}).join(` `)).attr(`transform`,`translate(`+-t/2+`,`+n/2+`)`)}var Ue={addToRender:Ve,addToRenderV2:He},We={},Ge=function(e){let t=Object.keys(e);for(let n of t)We[n]=e[n]},Ke=async function(e,t,n,r,i,a){let o=r?r.select(`[id="${n}"]`):O(`[id="${n}"]`),c=i||document,l=Object.keys(e);for(let n of l){let r=e[n],i=`default`;r.classes.length>0&&(i=r.classes.join(` `));let l=D(r.styles),u=r.text===void 0?r.id:r.text,d;if(C(T().flowchart.htmlLabels))d=s(o,{label:await S(u.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),T())}).node(),d.parentNode.removeChild(d);else{let e=c.createElementNS(`http://www.w3.org/2000/svg`,`text`);e.setAttribute(`style`,l.labelStyle.replace(`color:`,`fill:`));let t=u.split(x.lineBreakRegex);for(let n of t){let t=c.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);t.setAttributeNS(`http://www.w3.org/XML/1998/namespace`,`xml:space`,`preserve`),t.setAttribute(`dy`,`1em`),t.setAttribute(`x`,`1`),t.textContent=n,e.appendChild(t)}d=e}let f=0,p=``;switch(r.type){case`round`:f=5,p=`rect`;break;case`square`:p=`rect`;break;case`diamond`:p=`question`;break;case`hexagon`:p=`hexagon`;break;case`odd`:p=`rect_left_inv_arrow`;break;case`lean_right`:p=`lean_right`;break;case`lean_left`:p=`lean_left`;break;case`trapezoid`:p=`trapezoid`;break;case`inv_trapezoid`:p=`inv_trapezoid`;break;case`odd_right`:p=`rect_left_inv_arrow`;break;case`circle`:p=`circle`;break;case`ellipse`:p=`ellipse`;break;case`stadium`:p=`stadium`;break;case`subroutine`:p=`subroutine`;break;case`cylinder`:p=`cylinder`;break;case`group`:p=`rect`;break;default:p=`rect`}v.warn(`Adding node`,r.id,r.domId),t.setNode(a.db.lookUpDomId(r.id),{labelType:`svg`,labelStyle:l.labelStyle,shape:p,label:d,rx:f,ry:f,class:i,style:l.style,id:a.db.lookUpDomId(r.id)})}},$=async function(e,t,n){let r=0,i,a;if(e.defaultStyle!==void 0){let t=D(e.defaultStyle);i=t.style,a=t.labelStyle}for(let o of e){r++;let s=`L-`+o.start+`-`+o.end,c=`LS-`+o.start,l=`LE-`+o.end,u={};o.type===`arrow_open`?u.arrowhead=`none`:u.arrowhead=`normal`;let d=``,f=``;if(o.style!==void 0){let e=D(o.style);d=e.style,f=e.labelStyle}else switch(o.stroke){case`normal`:d=`fill:none`,i!==void 0&&(d=i),a!==void 0&&(f=a);break;case`dotted`:d=`fill:none;stroke-width:2px;stroke-dasharray:3;`;break;case`thick`:d=` stroke-width: 3.5px;fill:none`;break}u.style=d,u.labelStyle=f,o.interpolate===void 0?e.defaultInterpolate===void 0?u.curve=E(We.curve,b):u.curve=E(e.defaultInterpolate,b):u.curve=E(o.interpolate,b),o.text===void 0?o.style!==void 0&&(u.arrowheadStyle=`fill: #333`):(u.arrowheadStyle=`fill: #333`,u.labelpos=`c`,C(T().flowchart.htmlLabels)?(u.labelType=`html`,u.label=`<span id="L-${s}" class="edgeLabel L-${c}' L-${l}" style="${u.labelStyle}">${await S(o.text.replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(`:`,` `)}'></i>`),T())}</span>`):(u.labelType=`text`,u.label=o.text.replace(x.lineBreakRegex,`
`),o.style===void 0&&(u.style=u.style||`stroke: #333; stroke-width: 1.5px;fill:none`),u.labelStyle=u.labelStyle.replace(`color:`,`fill:`))),u.id=s,u.class=c+` `+l,u.minlen=o.length||1,t.setEdge(n.db.lookUpDomId(o.start),n.db.lookUpDomId(o.end),u,r)}},qe={setConf:Ge,addVertices:Ke,addEdges:$,getClasses:function(e,t){return v.info(`Extracting classes`),t.db.getClasses()},draw:async function(e,n,r,a){v.info(`Drawing flowchart`);let{securityLevel:o,flowchart:s}=T(),c;o===`sandbox`&&(c=O(`#i`+n));let l=O(o===`sandbox`?c.nodes()[0].contentDocument.body:`body`),u=o===`sandbox`?c.nodes()[0].contentDocument:document,d=a.db.getDirection();d===void 0&&(d=`TD`);let p=s.nodeSpacing||50,m=s.rankSpacing||50,h=new f({multigraph:!0,compound:!0}).setGraph({rankdir:d,nodesep:p,ranksep:m,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),g,_=a.db.getSubGraphs();for(let e=_.length-1;e>=0;e--)g=_[e],a.db.addVertex(g.id,g.title,`group`,void 0,g.classes);let y=a.db.getVertices();v.warn(`Get vertices`,y);let b=a.db.getEdges(),x=0;for(x=_.length-1;x>=0;x--){g=_[x],i(`cluster`).append(`text`);for(let e=0;e<g.nodes.length;e++)v.warn(`Setting subgraph`,g.nodes[e],a.db.lookUpDomId(g.nodes[e]),a.db.lookUpDomId(g.id)),h.setParent(a.db.lookUpDomId(g.nodes[e]),a.db.lookUpDomId(g.id))}await Ke(y,h,n,l,u,a),await $(b,h,a);let S=new Ne;Ue.addToRender(S),S.arrows().none=function(e,n,r,i){t(e.append(`marker`).attr(`id`,n).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 0 0 L 0 0 z`),r[i+`Style`])},S.arrows().normal=function(e,t){e.append(`marker`).attr(`id`,t).attr(`viewBox`,`0 0 10 10`).attr(`refX`,9).attr(`refY`,5).attr(`markerUnits`,`strokeWidth`).attr(`markerWidth`,8).attr(`markerHeight`,6).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 0 0 L 10 5 L 0 10 z`).attr(`class`,`arrowheadPath`).style(`stroke-width`,1).style(`stroke-dasharray`,`1,0`)};let C=l.select(`[id="${n}"]`),w=l.select(`#`+n+` g`);for(S(w,h),w.selectAll(`g.node`).attr(`title`,function(){return a.db.getTooltip(this.id)}),a.db.indexNodes(`subGraph`+x),x=0;x<_.length;x++)if(g=_[x],g.title!==`undefined`){let e=u.querySelectorAll(`#`+n+` [id="`+a.db.lookUpDomId(g.id)+`"] rect`),t=u.querySelectorAll(`#`+n+` [id="`+a.db.lookUpDomId(g.id)+`"]`),r=e[0].x.baseVal.value,i=e[0].y.baseVal.value,o=e[0].width.baseVal.value,s=O(t[0]).select(`.label`);s.attr(`transform`,`translate(${r+o/2}, ${i+14})`),s.attr(`id`,n+`Text`);for(let e=0;e<g.classes.length;e++)t[0].classList.add(g.classes[e])}if(!s.htmlLabels){let e=u.querySelectorAll(`[id="`+n+`"] .edgeLabel .label`);for(let t of e){let e=t.getBBox(),n=u.createElementNS(`http://www.w3.org/2000/svg`,`rect`);n.setAttribute(`rx`,0),n.setAttribute(`ry`,0),n.setAttribute(`width`,e.width),n.setAttribute(`height`,e.height),t.insertBefore(n,t.firstChild)}}ee(h,C,s.diagramPadding,s.useMaxWidth),Object.keys(y).forEach(function(e){let t=y[e];if(t.link){let r=l.select(`#`+n+` [id="`+a.db.lookUpDomId(e)+`"]`);if(r){let e=u.createElementNS(`http://www.w3.org/2000/svg`,`a`);e.setAttributeNS(`http://www.w3.org/2000/svg`,`class`,t.classes.join(` `)),e.setAttributeNS(`http://www.w3.org/2000/svg`,`href`,t.link),e.setAttributeNS(`http://www.w3.org/2000/svg`,`rel`,`noopener`),o===`sandbox`?e.setAttributeNS(`http://www.w3.org/2000/svg`,`target`,`_top`):t.linkTarget&&e.setAttributeNS(`http://www.w3.org/2000/svg`,`target`,t.linkTarget);let n=r.insert(function(){return e},`:first-child`),i=r.select(`.label-container`);i&&n.append(function(){return i.node()});let a=r.select(`.label`);a&&n.append(function(){return a.node()})}}})}},Je={parser:ne,db:k,renderer:l,styles:a,init:e=>{e.flowchart||={},e.flowchart.arrowMarkerAbsolute=e.arrowMarkerAbsolute,qe.setConf(e.flowchart),k.clear(),k.setGen(`gen-1`)}};export{Je as diagram};