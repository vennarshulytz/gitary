import{_ as e,a as t,b as n,c as r,d as i,f as a,g as o,h as s,i as c,l,m as u,n as d,o as f,p,r as m,s as h,t as g,u as ee,v as te,x as _,y as ne}from"./graphlib-BHWQpCg7.js";import{At as re,Ct as ie,Et as ae,Nt as v,Ot as oe,Tt as se,ft as y,ht as ce,jt as b,kt as le,wt as x}from"./mermaid-b5860b54-2w0nS4l5.js";import{$t as ue,B as de,D as fe,Jt as pe,L as S,N as me,O as he,U as C,Xt as ge,Yt as w,Zt as _e,_ as ve,tn as ye,z as be}from"./app-DxS3fFzF.js";var xe=1/0,Se=17976931348623157e292;function Ce(e){return e?(e=pe(e),e===xe||e===-xe?(e<0?-1:1)*Se:e===e?e:0):e===0?e:0}var T=Ce;function we(e){var t=T(e),n=t%1;return t===t?n?t-n:t:0}var Te=we;function Ee(e){return e!=null&&e.length?s(e,1):[]}var E=Ee;function De(e){return re(ae(e,void 0,E),e+``)}var Oe=De,ke=RegExp(`[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]`);function Ae(e){return ke.test(e)}var je=Ae,Me=1,Ne=4;function Pe(e){return u(e,Me|Ne)}var Fe=Pe,Ie=Object.prototype,Le=Ie.hasOwnProperty,Re=se(function(e,t){e=Object(e);var n=-1,r=t.length,i=r>2?t[2]:void 0;for(i&&x(t[0],t[1],i)&&(r=1);++n<r;)for(var a=t[n],o=ie(a),s=-1,c=o.length;++s<c;){var l=o[s],u=e[l];(u===void 0||be(u,Ie[l])&&!Le.call(e,l))&&(e[l]=a[l])}return e});function ze(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var D=ze;function Be(e){return function(t,n,r){var a=Object(t);if(!S(t)){var o=i(n,3);t=fe(t),n=function(e){return o(a[e],e,a)}}var s=e(t,n,r);return s>-1?a[o?t[s]:s]:void 0}}var Ve=Be,He=Math.max;function Ue(e,t,r){var a=e==null?0:e.length;if(!a)return-1;var o=r==null?0:Te(r);return o<0&&(o=He(a+o,0)),n(e,i(t,3),o)}var O=Ve(Ue);function We(e,t){var n=-1,r=S(e)?Array(e.length):[];return l(e,function(e,i,a){r[++n]=t(e,i,a)}),r}var Ge=We;function Ke(e,t){return(C(e)?_:Ge)(e,i(t,3))}var k=Ke;function qe(e,t){return e==null?e:ce(e,r(t),ie)}var Je=qe;function Ye(e,t){return e&&ee(e,r(t))}var Xe=Ye;function Ze(e,t){return e>t}var Qe=Ze,$e=`[object String]`;function et(e){return typeof e==`string`||!C(e)&&ge(e)&&_e(e)==$e}var tt=et;function nt(e,t){return e<t}var rt=nt;function it(e,t){var n={};return t=i(t,3),ee(e,function(e,r,i){le(n,r,t(e,r,i))}),n}var A=it;function at(e,t,n){for(var r=-1,i=e.length;++r<i;){var a=e[r],o=t(a);if(o!=null&&(s===void 0?o===o&&!w(o):n(o,s)))var s=o,c=a}return c}var j=at;function ot(e){return e&&e.length?j(e,v,Qe):void 0}var M=ot;function st(e){return e&&e.length?j(e,v,rt):void 0}var N=st;function ct(e,t){return e&&e.length?j(e,i(t,2),rt):void 0}var P=ct;function lt(t,n,r,i){if(!ye(t))return t;n=te(n,t);for(var a=-1,o=n.length,s=o-1,c=t;c!=null&&++a<o;){var l=e(n[a]),u=r;if(l===`__proto__`||l===`constructor`||l===`prototype`)return t;if(a!=s){var d=c[l];u=i?i(d,l,c):void 0,u===void 0&&(u=ye(d)?d:de(n[a+1])?[]:{})}oe(c,l,u),c=c[l]}return t}var ut=lt;function dt(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var s=t[r],c=o(e,s);n(c,s)&&ut(a,te(s,e),c)}return a}var ft=dt;function pt(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var mt=pt;function ht(e,t){if(e!==t){var n=e!==void 0,r=e===null,i=e===e,a=w(e),o=t!==void 0,s=t===null,c=t===t,l=w(t);if(!s&&!l&&!a&&e>t||a&&o&&c&&!s&&!l||r&&o&&c||!n&&c||!i)return 1;if(!r&&!a&&!l&&e<t||l&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!c)return-1}return 0}var gt=ht;function _t(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var c=gt(i[r],a[r]);if(c)return r>=s?c:c*(n[r]==`desc`?-1:1)}return e.index-t.index}var vt=_t;function yt(e,t,n){t=t.length?_(t,function(e){return C(e)?function(t){return o(t,e.length===1?e[0]:e)}:e}):[v];var r=-1;return t=_(t,me(i)),mt(Ge(e,function(e,n,i){return{criteria:_(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return vt(e,t,n)})}var bt=yt,xt=a(`length`),St=`\\ud800-\\udfff`,Ct=`\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff`,wt=`\\ufe0e\\ufe0f`,Tt=`[`+St+`]`,F=`[`+Ct+`]`,I=`\\ud83c[\\udffb-\\udfff]`,Et=`(?:`+F+`|`+I+`)`,Dt=`[^`+St+`]`,Ot=`(?:\\ud83c[\\udde6-\\uddff]){2}`,kt=`[\\ud800-\\udbff][\\udc00-\\udfff]`,At=`\\u200d`,jt=Et+`?`,Mt=`[`+wt+`]?`,Nt=`(?:`+At+`(?:`+[Dt,Ot,kt].join(`|`)+`)`+Mt+jt+`)*`,Pt=Mt+jt+Nt,Ft=`(?:`+[Dt+F+`?`,F,Ot,kt,Tt].join(`|`)+`)`,It=RegExp(I+`(?=`+I+`)|`+Ft+Pt,`g`);function Lt(e){for(var t=It.lastIndex=0;It.test(e);)++t;return t}var Rt=Lt;function zt(e){return je(e)?Rt(e):xt(e)}var Bt=zt;function Vt(e,t){return ft(e,t,function(t,n){return p(e,n)})}var Ht=Vt,L=Oe(function(e,t){return e==null?{}:Ht(e,t)}),Ut=Math.ceil,Wt=Math.max;function Gt(e,t,n,r){for(var i=-1,a=Wt(Ut((t-e)/(n||1)),0),o=Array(a);a--;)o[r?a:++i]=e,e+=n;return o}var Kt=Gt;function qt(e){return function(t,n,r){return r&&typeof r!=`number`&&x(t,n,r)&&(n=r=void 0),t=T(t),n===void 0?(n=t,t=0):n=T(n),r=r===void 0?t<n?1:-1:T(r),Kt(t,n,r,e)}}var R=qt(),Jt=`[object Map]`,Yt=`[object Set]`;function Xt(e){if(e==null)return 0;if(S(e))return tt(e)?Bt(e):e.length;var t=ve(e);return t==Jt||t==Yt?e.size:he(e).length}var Zt=Xt,z=se(function(e,t){if(e==null)return[];var n=t.length;return n>1&&x(e,t[0],t[1])?t=[]:n>2&&x(t[0],t[1],t[2])&&(t=[t[0]]),bt(e,s(t,1),[])}),Qt=0;function $t(e){var t=++Qt;return ne(e)+t}var B=$t;function en(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s)}return o}var tn=en;function nn(e,t){return tn(e||[],t||[],oe)}var rn=nn,an=class{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return on(t),t}enqueue(e){var t=this._sentinel;e._prev&&e._next&&on(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t}toString(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,sn)),n=n._prev;return`[`+e.join(`, `)+`]`}};function on(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function sn(e,t){if(e!==`_next`&&e!==`_prev`)return t}var cn=b(1);function ln(e,t){if(e.nodeCount()<=1)return[];var n=dn(e,t||cn);return E(k(un(n.graph,n.buckets,n.zeroIdx),function(t){return e.outEdges(t.v,t.w)}))}function un(e,t,n){for(var r=[],i=t[t.length-1],a=t[0],o;e.nodeCount();){for(;o=a.dequeue();)V(e,t,n,o);for(;o=i.dequeue();)V(e,t,n,o);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(V(e,t,n,o,!0));break}}}return r}function V(e,t,n,r,i){var a=i?[]:void 0;return h(e.inEdges(r.v),function(r){var o=e.edge(r),s=e.node(r.v);i&&a.push({v:r.v,w:r.w}),s.out-=o,H(t,n,s)}),h(e.outEdges(r.v),function(r){var i=e.edge(r),a=r.w,o=e.node(a);o.in-=i,H(t,n,o)}),e.removeNode(r.v),a}function dn(e,t){var n=new g,r=0,i=0;h(e.nodes(),function(e){n.setNode(e,{v:e,in:0,out:0})}),h(e.edges(),function(e){var a=n.edge(e.v,e.w)||0,o=t(e),s=a+o;n.setEdge(e.v,e.w,s),i=Math.max(i,n.node(e.v).out+=o),r=Math.max(r,n.node(e.w).in+=o)});var a=R(i+r+3).map(function(){return new an}),o=r+1;return h(n.nodes(),function(e){H(a,o,n.node(e))}),{graph:n,buckets:a,zeroIdx:o}}function H(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function fn(e){h(e.graph().acyclicer===`greedy`?ln(e,t(e)):pn(e),function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,B(`rev`))});function t(e){return function(t){return e.edge(t).weight}}}function pn(e){var n=[],r={},i={};function a(o){t(i,o)||(i[o]=!0,r[o]=!0,h(e.outEdges(o),function(e){t(r,e.w)?n.push(e):a(e.w)}),delete r[o])}return h(e.nodes(),a),n}function mn(e){h(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}function U(e,t,n,r){var i;do i=B(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function hn(e){var t=new g().setGraph(e.graph());return h(e.nodes(),function(n){t.setNode(n,e.node(n))}),h(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function gn(e){var t=new g({multigraph:e.isMultigraph()}).setGraph(e.graph());return h(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),h(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function _n(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2;if(!i&&!a)throw Error(`Not possible to find intersection inside of the rectangle`);var c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}}function W(e){var t=k(R(xn(e)+1),function(){return[]});return h(e.nodes(),function(n){var r=e.node(n),i=r.rank;m(i)||(t[i][r.order]=n)}),t}function vn(e){var n=N(k(e.nodes(),function(t){return e.node(t).rank}));h(e.nodes(),function(r){var i=e.node(r);t(i,`rank`)&&(i.rank-=n)})}function yn(e){var t=N(k(e.nodes(),function(t){return e.node(t).rank})),n=[];h(e.nodes(),function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)});var r=0,i=e.graph().nodeRankFactor;h(n,function(t,n){m(t)&&n%i!==0?--r:r&&h(t,function(t){e.node(t).rank+=r})})}function bn(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),U(e,`border`,i,t)}function xn(e){return M(k(e.nodes(),function(t){var n=e.node(t).rank;if(!m(n))return n}))}function Sn(e,t){var n={lhs:[],rhs:[]};return h(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n}function Cn(e,t){var n=ue();try{return t()}finally{console.log(e+` time: `+(ue()-n)+`ms`)}}function wn(e,t){return t()}function Tn(e){function n(r){var i=e.children(r),a=e.node(r);if(i.length&&h(i,n),t(a,`minRank`)){a.borderLeft=[],a.borderRight=[];for(var o=a.minRank,s=a.maxRank+1;o<s;++o)En(e,`borderLeft`,`_bl`,r,a,o),En(e,`borderRight`,`_br`,r,a,o)}}h(e.children(),n)}function En(e,t,n,r,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],c=U(e,`border`,o,n);i[t][a]=c,e.setParent(c,r),s&&e.setEdge(s,c,{weight:1})}function Dn(e){var t=e.graph().rankdir.toLowerCase();(t===`lr`||t===`rl`)&&kn(e)}function On(e){var t=e.graph().rankdir.toLowerCase();(t===`bt`||t===`rl`)&&jn(e),(t===`lr`||t===`rl`)&&(Mn(e),kn(e))}function kn(e){h(e.nodes(),function(t){An(e.node(t))}),h(e.edges(),function(t){An(e.edge(t))})}function An(e){var t=e.width;e.width=e.height,e.height=t}function jn(e){h(e.nodes(),function(t){G(e.node(t))}),h(e.edges(),function(n){var r=e.edge(n);h(r.points,G),t(r,`y`)&&G(r)})}function G(e){e.y=-e.y}function Mn(e){h(e.nodes(),function(t){K(e.node(t))}),h(e.edges(),function(n){var r=e.edge(n);h(r.points,K),t(r,`x`)&&K(r)})}function K(e){var t=e.x;e.x=e.y,e.y=t}function Nn(e){e.graph().dummyChains=[],h(e.edges(),function(t){Pn(e,t)})}function Pn(e,t){var n=t.v,r=e.node(n).rank,i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),c=s.labelRank;if(a!==r+1){e.removeEdge(t);var l,u,d;for(d=0,++r;r<a;++d,++r)s.points=[],u={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},l=U(e,`edge`,u,`_d`),r===c&&(u.width=s.width,u.height=s.height,u.dummy=`edge-label`,u.labelpos=s.labelpos),e.setEdge(n,l,{weight:s.weight},o),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,i,{weight:s.weight},o)}}function Fn(e){h(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy===`edge-label`&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}function q(e){var n={};function r(i){var a=e.node(i);if(t(n,i))return a.rank;n[i]=!0;var o=N(k(e.outEdges(i),function(t){return r(t.w)-e.edge(t).minlen}));return(o===1/0||o==null)&&(o=0),a.rank=o}h(e.sources(),r)}function J(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function In(e){var t=new g({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,a;Ln(t,e)<r;)i=Rn(t,e),a=t.hasNode(i.v)?J(e,i):-J(e,i),zn(t,e,a);return t}function Ln(e,t){function n(r){h(t.nodeEdges(r),function(i){var a=i.v,o=r===a?i.w:a;!e.hasNode(o)&&!J(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}return h(e.nodes(),n),e.nodeCount()}function Rn(e,t){return P(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return J(t,n)})}function zn(e,t,n){h(e.nodes(),function(e){t.node(e).rank+=n})}b(1),b(1),Bn.CycleException=Y;function Bn(e){var n={},r={},i=[];function a(o){if(t(r,o))throw new Y;t(n,o)||(r[o]=!0,n[o]=!0,h(e.predecessors(o),a),delete r[o],i.push(o))}if(h(e.sinks(),a),Zt(n)!==e.nodeCount())throw new Y;return i}function Y(){}Y.prototype=Error();function Vn(e,t,n){C(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return h(t,function(t){if(!e.hasNode(t))throw Error(`Graph does not have node: `+t);Hn(e,t,n===`post`,a,r,i)}),i}function Hn(e,n,r,i,a,o){t(i,n)||(i[n]=!0,r||o.push(n),h(a(n),function(t){Hn(e,t,r,i,a,o)}),r&&o.push(n))}function Un(e,t){return Vn(e,t,`post`)}function Wn(e,t){return Vn(e,t,`pre`)}X.initLowLimValues=Q,X.initCutValues=Z,X.calcCutValue=Kn,X.leaveEdge=Jn,X.enterEdge=Yn,X.exchangeEdges=Xn;function X(e){e=hn(e),q(e);var t=In(e);Q(t),Z(t,e);for(var n,r;n=Jn(t);)r=Yn(t,e,n),Xn(t,e,n,r)}function Z(e,t){var n=Un(e,e.nodes());n=n.slice(0,n.length-1),h(n,function(n){Gn(e,t,n)})}function Gn(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=Kn(e,t,n)}function Kn(e,t,n){var r=e.node(n).parent,i=!0,a=t.edge(n,r),o=0;return a||=(i=!1,t.edge(r,n)),o=a.weight,h(t.nodeEdges(n),function(a){var s=a.v===n,c=s?a.w:a.v;if(c!==r){var l=s===i,u=t.edge(a).weight;if(o+=l?u:-u,Qn(e,n,c)){var d=e.edge(n,c).cutvalue;o+=l?-d:d}}}),o}function Q(e,t){arguments.length<2&&(t=e.nodes()[0]),qn(e,{},1,t)}function qn(e,n,r,i,a){var o=r,s=e.node(i);return n[i]=!0,h(e.neighbors(i),function(a){t(n,a)||(r=qn(e,n,r,a,i))}),s.low=o,s.lim=r++,a?s.parent=a:delete s.parent,r}function Jn(e){return O(e.edges(),function(t){return e.edge(t).cutvalue<0})}function Yn(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var a=e.node(r),o=e.node(i),s=a,c=!1;return a.lim>o.lim&&(s=o,c=!0),P(f(t.edges(),function(t){return c===$n(e,e.node(t.v),s)&&c!==$n(e,e.node(t.w),s)}),function(e){return J(t,e)})}function Xn(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),Q(e),Z(e,t),Zn(e,t)}function Zn(e,t){var n=Wn(e,O(e.nodes(),function(e){return!t.node(e).parent}));n=n.slice(1),h(n,function(n){var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen)})}function Qn(e,t,n){return e.hasEdge(t,n)}function $n(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}function er(e){switch(e.graph().ranker){case`network-simplex`:rr(e);break;case`tight-tree`:nr(e);break;case`longest-path`:tr(e);break;default:rr(e)}}var tr=q;function nr(e){q(e),In(e)}function rr(e){X(e)}function ir(e){var t=U(e,`root`,{},`_root`),n=or(e),r=M(c(n))-1,i=2*r+1;e.graph().nestingRoot=t,h(e.edges(),function(t){e.edge(t).minlen*=i});var a=sr(e)+1;h(e.children(),function(o){ar(e,t,i,a,r,n,o)}),e.graph().nodeRankFactor=i}function ar(e,t,n,r,i,a,o){var s=e.children(o);if(!s.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}var c=bn(e,`_bt`),l=bn(e,`_bb`),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(l,o),u.borderBottom=l,h(s,function(s){ar(e,t,n,r,i,a,s);var u=e.node(s),d=u.borderTop?u.borderTop:s,f=u.borderBottom?u.borderBottom:s,p=u.borderTop?r:2*r,m=d===f?i-a[o]+1:1;e.setEdge(c,d,{weight:p,minlen:m,nestingEdge:!0}),e.setEdge(f,l,{weight:p,minlen:m,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+a[o]})}function or(e){var t={};function n(r,i){var a=e.children(r);a&&a.length&&h(a,function(e){n(e,i+1)}),t[r]=i}return h(e.children(),function(e){n(e,1)}),t}function sr(e){return d(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function cr(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,h(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}function lr(e,t,n){var r={},i;h(n,function(n){for(var a=e.parent(n),o,s;a;){if(o=e.parent(a),o?(s=r[o],r[o]=a):(s=i,i=a),s&&s!==a){t.setEdge(s,a);return}a=o}})}function ur(e,n,r){var i=dr(e),a=new g({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(t){return e.node(t)});return h(e.nodes(),function(o){var s=e.node(o),c=e.parent(o);(s.rank===n||s.minRank<=n&&n<=s.maxRank)&&(a.setNode(o),a.setParent(o,c||i),h(e[r](o),function(t){var n=t.v===o?t.w:t.v,r=a.edge(n,o),i=m(r)?0:r.weight;a.setEdge(n,o,{weight:e.edge(t).weight+i})}),t(s,`minRank`)&&a.setNode(o,{borderLeft:s.borderLeft[n],borderRight:s.borderRight[n]}))}),a}function dr(e){for(var t;e.hasNode(t=B(`_root`)););return t}function fr(e,t){for(var n=0,r=1;r<t.length;++r)n+=pr(e,t[r-1],t[r]);return n}function pr(e,t,n){for(var r=rn(n,k(n,function(e,t){return t})),i=E(k(t,function(t){return z(k(e.outEdges(t),function(t){return{pos:r[t.w],weight:e.edge(t).weight}}),`pos`)})),a=1;a<n.length;)a<<=1;var o=2*a-1;--a;var s=k(Array(o),function(){return 0}),c=0;return h(i.forEach(function(e){var t=e.pos+a;s[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=s[t+1]),t=t-1>>1,s[t]+=e.weight;c+=e.weight*n})),c}function mr(e){var n={},r=f(e.nodes(),function(t){return!e.children(t).length}),i=k(R(M(k(r,function(t){return e.node(t).rank}))+1),function(){return[]});function a(r){t(n,r)||(n[r]=!0,i[e.node(r).rank].push(r),h(e.successors(r),a))}return h(z(r,function(t){return e.node(t).rank}),a),i}function hr(e,t){return k(t,function(t){var n=e.inEdges(t);if(n.length){var r=d(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:t}})}function gr(e,t){var n={};return h(e,function(e,t){var r=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};m(e.barycenter)||(r.barycenter=e.barycenter,r.weight=e.weight)}),h(t.edges(),function(e){var t=n[e.v],r=n[e.w];!m(t)&&!m(r)&&(r.indegree++,t.out.push(n[e.w]))}),_r(f(n,function(e){return!e.indegree}))}function _r(e){var t=[];function n(e){return function(t){t.merged||(m(t.barycenter)||m(e.barycenter)||t.barycenter>=e.barycenter)&&vr(e,t)}}function r(t){return function(n){n.in.push(t),--n.indegree===0&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),h(i.in.reverse(),n(i)),h(i.out,r(i))}return k(f(t,function(e){return!e.merged}),function(e){return L(e,[`vs`,`i`,`barycenter`,`weight`])})}function vr(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}function yr(e,n){var r=Sn(e,function(e){return t(e,`barycenter`)}),i=r.lhs,a=z(r.rhs,function(e){return-e.i}),o=[],s=0,c=0,l=0;i.sort(xr(!!n)),l=br(o,a,l),h(i,function(e){l+=e.vs.length,o.push(e.vs),s+=e.barycenter*e.weight,c+=e.weight,l=br(o,a,l)});var u={vs:E(o)};return c&&(u.barycenter=s/c,u.weight=c),u}function br(e,t,n){for(var r;t.length&&(r=D(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function xr(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}function Sr(e,n,r,i){var a=e.children(n),o=e.node(n),s=o?o.borderLeft:void 0,c=o?o.borderRight:void 0,l={};s&&(a=f(a,function(e){return e!==s&&e!==c}));var u=hr(e,a);h(u,function(n){if(e.children(n.v).length){var a=Sr(e,n.v,r,i);l[n.v]=a,t(a,`barycenter`)&&wr(n,a)}});var d=gr(u,r);Cr(d,l);var p=yr(d,i);if(s&&(p.vs=E([s,p.vs,c]),e.predecessors(s).length)){var m=e.node(e.predecessors(s)[0]),g=e.node(e.predecessors(c)[0]);t(p,`barycenter`)||(p.barycenter=0,p.weight=0),p.barycenter=(p.barycenter*p.weight+m.order+g.order)/(p.weight+2),p.weight+=2}return p}function Cr(e,t){h(e,function(e){e.vs=E(e.vs.map(function(e){return t[e]?t[e].vs:e}))})}function wr(e,t){m(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}function Tr(e){var t=xn(e),n=Er(e,R(1,t+1),`inEdges`),r=Er(e,R(t-1,-1,-1),`outEdges`),i=mr(e);Or(e,i);for(var a=1/0,o,s=0,c=0;c<4;++s,++c){Dr(s%2?n:r,s%4>=2),i=W(e);var l=fr(e,i);l<a&&(c=0,o=Fe(i),a=l)}Or(e,o)}function Er(e,t,n){return k(t,function(t){return ur(e,t,n)})}function Dr(e,t){var n=new g;h(e,function(e){var r=e.graph().root,i=Sr(e,r,n,t);h(i.vs,function(t,n){e.node(t).order=n}),lr(e,n,i.vs)})}function Or(e,t){h(t,function(t){h(t,function(t,n){e.node(t).order=n})})}function kr(e){var t=jr(e);h(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,a=Ar(e,t,i.v,i.w),o=a.path,s=a.lca,c=0,l=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(l=o[c])!==s&&e.node(l).maxRank<r.rank;)c++;l===s&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(l=o[c+1]).minRank<=r.rank;)c++;l=o[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function Ar(e,t,n,r){var i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c=n,l;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}function jr(e){var t={},n=0;function r(i){var a=n;h(e.children(i),r),t[i]={low:a,lim:n++}}return h(e.children(),r),t}function Mr(e,t){var n={};function r(t,r){var i=0,a=0,o=t.length,s=D(r);return h(r,function(t,c){var l=Pr(e,t),u=l?e.node(l).order:o;(l||t===s)&&(h(r.slice(a,c+1),function(t){h(e.predecessors(t),function(r){var a=e.node(r),o=a.order;(o<i||u<o)&&!(a.dummy&&e.node(t).dummy)&&Fr(n,r,t)})}),a=c+1,i=u)}),r}return d(t,r),n}function Nr(e,t){var n={};function r(t,r,i,a,o){var s;h(R(r,i),function(r){s=t[r],e.node(s).dummy&&h(e.predecessors(s),function(t){var r=e.node(t);r.dummy&&(r.order<a||r.order>o)&&Fr(n,t,s)})})}function i(t,n){var i=-1,a,o=0;return h(n,function(s,c){if(e.node(s).dummy===`border`){var l=e.predecessors(s);l.length&&(a=e.node(l[0]).order,r(n,o,c,i,a),o=c,i=a)}r(n,o,n.length,a,t.length)}),n}return d(t,i),n}function Pr(e,t){if(e.node(t).dummy)return O(e.predecessors(t),function(t){return e.node(t).dummy})}function Fr(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function Ir(e,n,r){if(n>r){var i=n;n=r,r=i}return t(e[n],r)}function Lr(e,t,n,r){var i={},a={},o={};return h(t,function(e){h(e,function(e,t){i[e]=e,a[e]=e,o[e]=t})}),h(t,function(e){var t=-1;h(e,function(e){var s=r(e);if(s.length){s=z(s,function(e){return o[e]});for(var c=(s.length-1)/2,l=Math.floor(c),u=Math.ceil(c);l<=u;++l){var d=s[l];a[e]===e&&t<o[d]&&!Ir(n,e,d)&&(a[d]=e,a[e]=i[e]=i[d],t=o[d])}}})}),{root:i,align:a}}function Rr(e,t,n,r,i){var a={},o=zr(e,t,n,i),s=i?`borderLeft`:`borderRight`;function c(e,t){for(var n=o.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}function l(e){a[e]=o.inEdges(e).reduce(function(e,t){return Math.max(e,a[t.v]+o.edge(t))},0)}function u(t){var n=o.outEdges(t).reduce(function(e,t){return Math.min(e,a[t.w]-o.edge(t))},1/0),r=e.node(t);n!==1/0&&r.borderType!==s&&(a[t]=Math.max(a[t],n))}return c(l,o.predecessors.bind(o)),c(u,o.successors.bind(o)),h(r,function(e){a[e]=a[n[e]]}),a}function zr(e,t,n,r){var i=new g,a=e.graph(),o=Wr(a.nodesep,a.edgesep,r);return h(t,function(t){var r;h(t,function(t){var a=n[t];if(i.setNode(a),r){var s=n[r],c=i.edge(s,a);i.setEdge(s,a,Math.max(o(e,t,r),c||0))}r=t})}),i}function Br(e,t){return P(c(t),function(t){var n=-1/0,r=1/0;return Je(t,function(t,i){var a=Gr(e,i)/2;n=Math.max(t+a,n),r=Math.min(t-a,r)}),n-r})}function Vr(e,t){var n=c(t),r=N(n),i=M(n);h([`u`,`d`],function(n){h([`l`,`r`],function(a){var o=n+a,s=e[o],l;if(s!==t){var u=c(s);l=a===`l`?r-N(u):i-M(u),l&&(e[o]=A(s,function(e){return e+l}))}})})}function Hr(e,t){return A(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=z(k(e,r));return(i[1]+i[2])/2})}function Ur(e){var t=W(e),n=y(Mr(e,t),Nr(e,t)),r={},i;return h([`u`,`d`],function(a){i=a===`u`?t:c(t).reverse(),h([`l`,`r`],function(t){t===`r`&&(i=k(i,function(e){return c(e).reverse()}));var o=(a===`u`?e.predecessors:e.successors).bind(e),s=Lr(e,i,n,o),l=Rr(e,i,s.root,s.align,t===`r`);t===`r`&&(l=A(l,function(e){return-e})),r[a+t]=l})}),Vr(r,Br(e,r)),Hr(r,e.graph().align)}function Wr(e,n,r){return function(i,a,o){var s=i.node(a),c=i.node(o),l=0,u;if(l+=s.width/2,t(s,`labelpos`))switch(s.labelpos.toLowerCase()){case`l`:u=-s.width/2;break;case`r`:u=s.width/2;break}if(u&&(l+=r?u:-u),u=0,l+=(s.dummy?n:e)/2,l+=(c.dummy?n:e)/2,l+=c.width/2,t(c,`labelpos`))switch(c.labelpos.toLowerCase()){case`l`:u=c.width/2;break;case`r`:u=-c.width/2;break}return u&&(l+=r?u:-u),u=0,l}}function Gr(e,t){return e.node(t).width}function Kr(e){e=gn(e),qr(e),Xe(Ur(e),function(t,n){e.node(n).x=t})}function qr(e){var t=W(e),n=e.graph().ranksep,r=0;h(t,function(t){var i=M(k(t,function(t){return e.node(t).height}));h(t,function(t){e.node(t).y=r+i/2}),r+=i+n})}function Jr(e,t){var n=t&&t.debugTiming?Cn:wn;n(`layout`,function(){var t=n(`  buildLayoutGraph`,function(){return ai(e)});n(`  runLayout`,function(){Yr(t,n)}),n(`  updateInputGraph`,function(){Xr(e,t)})})}function Yr(e,t){t(`    makeSpaceForEdgeLabels`,function(){oi(e)}),t(`    removeSelfEdges`,function(){hi(e)}),t(`    acyclic`,function(){fn(e)}),t(`    nestingGraph.run`,function(){ir(e)}),t(`    rank`,function(){er(gn(e))}),t(`    injectEdgeLabelProxies`,function(){si(e)}),t(`    removeEmptyRanks`,function(){yn(e)}),t(`    nestingGraph.cleanup`,function(){cr(e)}),t(`    normalizeRanks`,function(){vn(e)}),t(`    assignRankMinMax`,function(){ci(e)}),t(`    removeEdgeLabelProxies`,function(){li(e)}),t(`    normalize.run`,function(){Nn(e)}),t(`    parentDummyChains`,function(){kr(e)}),t(`    addBorderSegments`,function(){Tn(e)}),t(`    order`,function(){Tr(e)}),t(`    insertSelfEdges`,function(){gi(e)}),t(`    adjustCoordinateSystem`,function(){Dn(e)}),t(`    position`,function(){Kr(e)}),t(`    positionSelfEdges`,function(){_i(e)}),t(`    removeBorderNodes`,function(){mi(e)}),t(`    normalize.undo`,function(){Fn(e)}),t(`    fixupEdgeLabelCoords`,function(){fi(e)}),t(`    undoCoordinateSystem`,function(){On(e)}),t(`    translateGraph`,function(){ui(e)}),t(`    assignNodeIntersects`,function(){di(e)}),t(`    reversePoints`,function(){pi(e)}),t(`    acyclic.undo`,function(){mn(e)})}function Xr(e,n){h(e.nodes(),function(t){var r=e.node(t),i=n.node(t);r&&(r.x=i.x,r.y=i.y,n.children(t).length&&(r.width=i.width,r.height=i.height))}),h(e.edges(),function(r){var i=e.edge(r),a=n.edge(r);i.points=a.points,t(a,`x`)&&(i.x=a.x,i.y=a.y)}),e.graph().width=n.graph().width,e.graph().height=n.graph().height}var Zr=[`nodesep`,`edgesep`,`ranksep`,`marginx`,`marginy`],Qr={ranksep:50,edgesep:20,nodesep:50,rankdir:`tb`},$r=[`acyclicer`,`ranker`,`rankdir`,`align`],ei=[`width`,`height`],ti={width:0,height:0},ni=[`minlen`,`weight`,`width`,`height`,`labeloffset`],ri={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},ii=[`labelpos`];function ai(e){var t=new g({multigraph:!0,compound:!0}),n=$(e.graph());return t.setGraph(y({},Qr,vi(n,Zr),L(n,$r))),h(e.nodes(),function(n){var r=$(e.node(n));t.setNode(n,Re(vi(r,ei),ti)),t.setParent(n,e.parent(n))}),h(e.edges(),function(n){var r=$(e.edge(n));t.setEdge(n,y({},ri,vi(r,ni),L(r,ii)))}),t}function oi(e){var t=e.graph();t.ranksep/=2,h(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!==`c`&&(t.rankdir===`TB`||t.rankdir===`BT`?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function si(e){h(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v);U(e,`edge-proxy`,{rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t},`_ep`)}})}function ci(e){var t=0;h(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=M(t,r.maxRank))}),e.graph().maxRank=t}function li(e){h(e.nodes(),function(t){var n=e.node(t);n.dummy===`edge-proxy`&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function ui(e){var n=1/0,r=0,i=1/0,a=0,o=e.graph(),s=o.marginx||0,c=o.marginy||0;function l(e){var t=e.x,o=e.y,s=e.width,c=e.height;n=Math.min(n,t-s/2),r=Math.max(r,t+s/2),i=Math.min(i,o-c/2),a=Math.max(a,o+c/2)}h(e.nodes(),function(t){l(e.node(t))}),h(e.edges(),function(n){var r=e.edge(n);t(r,`x`)&&l(r)}),n-=s,i-=c,h(e.nodes(),function(t){var r=e.node(t);r.x-=n,r.y-=i}),h(e.edges(),function(r){var a=e.edge(r);h(a.points,function(e){e.x-=n,e.y-=i}),t(a,`x`)&&(a.x-=n),t(a,`y`)&&(a.y-=i)}),o.width=r-n+s,o.height=a-i+c}function di(e){h(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(_n(r,a)),n.points.push(_n(i,o))})}function fi(e){h(e.edges(),function(n){var r=e.edge(n);if(t(r,`x`))switch((r.labelpos===`l`||r.labelpos===`r`)&&(r.width-=r.labeloffset),r.labelpos){case`l`:r.x-=r.width/2+r.labeloffset;break;case`r`:r.x+=r.width/2+r.labeloffset;break}})}function pi(e){h(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function mi(e){h(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),a=e.node(D(n.borderLeft)),o=e.node(D(n.borderRight));n.width=Math.abs(o.x-a.x),n.height=Math.abs(i.y-r.y),n.x=a.x+n.width/2,n.y=r.y+n.height/2}}),h(e.nodes(),function(t){e.node(t).dummy===`border`&&e.removeNode(t)})}function hi(e){h(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||=[],n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function gi(e){h(W(e),function(t){var n=0;h(t,function(t,r){var i=e.node(t);i.order=r+n,h(i.selfEdges,function(t){U(e,`selfedge`,{width:t.label.width,height:t.label.height,rank:i.rank,order:r+ ++n,e:t.e,label:t.label},`_se`)}),delete i.selfEdges})})}function _i(e){h(e.nodes(),function(t){var n=e.node(t);if(n.dummy===`selfedge`){var r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})}function vi(e,t){return A(L(e,t),Number)}function $(e){var t={};return h(e,function(e,n){t[n.toLowerCase()]=e}),t}export{k as a,L as i,B as n,Re as o,R as r,Jr as t};