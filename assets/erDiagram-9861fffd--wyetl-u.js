import"./chakra-ui-DL3iEWi3.js";import{xO as e}from"./excalidraw-WmC7xqr8.js";import{t}from"./graphlib-5cqa2Mg8.js";import{t as n}from"./dagre-4vJ33jfE.js";import{B as r,E as i,F as a,J as o,L as s,P as c,Y as l,_ as u,b as d,g as f,k as p,s as m,u as h,ut as g,v as _}from"./mermaid-b5860b54-DtYw2svQ.js";import{it as v}from"./app-DrkNGwf1.js";import"./path-CZHMXrTW.js";import"./array-DZBJPEBo.js";import{t as y}from"./line-Dm2jNoYD.js";var b=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function x(e){return typeof e==`string`&&b.test(e)}var S=x,C=[];for(let e=0;e<256;++e)C.push((e+256).toString(16).slice(1));function w(e,t=0){return C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+`-`+C[e[t+4]]+C[e[t+5]]+`-`+C[e[t+6]]+C[e[t+7]]+`-`+C[e[t+8]]+C[e[t+9]]+`-`+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]}function T(e){if(!S(e))throw TypeError(`Invalid UUID`);let t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=t&255,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=t&255,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=t&255,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=t&255,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=t&255,n}var E=T;function D(e){e=unescape(encodeURIComponent(e));let t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}function O(e,t,n){function r(e,r,i,a){if(typeof e==`string`&&(e=D(e)),typeof r==`string`&&(r=E(r)),r?.length!==16)throw TypeError(`Namespace must be array-like (16 iterable integer values, 0-255)`);let o=new Uint8Array(16+e.length);if(o.set(r),o.set(e,r.length),o=n(o),o[6]=o[6]&15|t,o[8]=o[8]&63|128,i){a||=0;for(let e=0;e<16;++e)i[a+e]=o[e];return i}return w(o)}try{r.name=e}catch{}return r.DNS=`6ba7b810-9dad-11d1-80b4-00c04fd430c8`,r.URL=`6ba7b811-9dad-11d1-80b4-00c04fd430c8`,r}function k(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function A(e,t){return e<<t|e>>>32-t}function j(e){let t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e==`string`){let t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let r=e.length/4+2,i=Math.ceil(r/16),a=Array(i);for(let t=0;t<i;++t){let n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[t*64+r*4]<<24|e[t*64+r*4+1]<<16|e[t*64+r*4+2]<<8|e[t*64+r*4+3];a[t]=n}a[i-1][14]=(e.length-1)*8/2**32,a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=(e.length-1)*8&4294967295;for(let e=0;e<i;++e){let r=new Uint32Array(80);for(let t=0;t<16;++t)r[t]=a[e][t];for(let e=16;e<80;++e)r[e]=A(r[e-3]^r[e-8]^r[e-14]^r[e-16],1);let i=n[0],o=n[1],s=n[2],c=n[3],l=n[4];for(let e=0;e<80;++e){let n=Math.floor(e/20),a=A(i,5)+k(n,o,s,c)+l+t[n]+r[e]>>>0;l=c,c=s,s=A(o,30)>>>0,o=i,i=a}n[0]=n[0]+i>>>0,n[1]=n[1]+o>>>0,n[2]=n[2]+s>>>0,n[3]=n[3]+c>>>0,n[4]=n[4]+l>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var M=O(`v5`,80,j);g(),e(),o();var N=function(){var e=function(e,t,n,r){for(n||={},r=e.length;r--;n[e[r]]=t);return n},t=[6,8,10,20,22,24,26,27,28],n=[1,10],r=[1,11],i=[1,12],a=[1,13],o=[1,14],s=[1,15],c=[1,21],l=[1,22],u=[1,23],d=[1,24],f=[1,25],p=[6,8,10,13,15,18,19,20,22,24,26,27,28,41,42,43,44,45],m=[1,34],h=[27,28,46,47],g=[41,42,43,44,45],_=[17,34],v=[1,54],y=[1,53],b=[17,34,36,38],x={trace:function(){},yy:{},symbols_:{error:2,start:3,ER_DIAGRAM:4,document:5,EOF:6,line:7,SPACE:8,statement:9,NEWLINE:10,entityName:11,relSpec:12,":":13,role:14,BLOCK_START:15,attributes:16,BLOCK_STOP:17,SQS:18,SQE:19,title:20,title_value:21,acc_title:22,acc_title_value:23,acc_descr:24,acc_descr_value:25,acc_descr_multiline_value:26,ALPHANUM:27,ENTITY_NAME:28,attribute:29,attributeType:30,attributeName:31,attributeKeyTypeList:32,attributeComment:33,ATTRIBUTE_WORD:34,attributeKeyType:35,COMMA:36,ATTRIBUTE_KEY:37,COMMENT:38,cardinality:39,relType:40,ZERO_OR_ONE:41,ZERO_OR_MORE:42,ONE_OR_MORE:43,ONLY_ONE:44,MD_PARENT:45,NON_IDENTIFYING:46,IDENTIFYING:47,WORD:48,$accept:0,$end:1},terminals_:{2:`error`,4:`ER_DIAGRAM`,6:`EOF`,8:`SPACE`,10:`NEWLINE`,13:`:`,15:`BLOCK_START`,17:`BLOCK_STOP`,18:`SQS`,19:`SQE`,20:`title`,21:`title_value`,22:`acc_title`,23:`acc_title_value`,24:`acc_descr`,25:`acc_descr_value`,26:`acc_descr_multiline_value`,27:`ALPHANUM`,28:`ENTITY_NAME`,34:`ATTRIBUTE_WORD`,36:`COMMA`,37:`ATTRIBUTE_KEY`,38:`COMMENT`,41:`ZERO_OR_ONE`,42:`ZERO_OR_MORE`,43:`ONE_OR_MORE`,44:`ONLY_ONE`,45:`MD_PARENT`,46:`NON_IDENTIFYING`,47:`IDENTIFYING`,48:`WORD`},productions_:[0,[3,3],[5,0],[5,2],[7,2],[7,1],[7,1],[7,1],[9,5],[9,4],[9,3],[9,1],[9,7],[9,6],[9,4],[9,2],[9,2],[9,2],[9,1],[11,1],[11,1],[16,1],[16,2],[29,2],[29,3],[29,3],[29,4],[30,1],[31,1],[32,1],[32,3],[35,1],[33,1],[12,3],[39,1],[39,1],[39,1],[39,1],[39,1],[40,1],[40,1],[14,1],[14,1],[14,1]],performAction:function(e,t,n,r,i,a,o){var s=a.length-1;switch(i){case 1:break;case 2:this.$=[];break;case 3:a[s-1].push(a[s]),this.$=a[s-1];break;case 4:case 5:this.$=a[s];break;case 6:case 7:this.$=[];break;case 8:r.addEntity(a[s-4]),r.addEntity(a[s-2]),r.addRelationship(a[s-4],a[s],a[s-2],a[s-3]);break;case 9:r.addEntity(a[s-3]),r.addAttributes(a[s-3],a[s-1]);break;case 10:r.addEntity(a[s-2]);break;case 11:r.addEntity(a[s]);break;case 12:r.addEntity(a[s-6],a[s-4]),r.addAttributes(a[s-6],a[s-1]);break;case 13:r.addEntity(a[s-5],a[s-3]);break;case 14:r.addEntity(a[s-3],a[s-1]);break;case 15:case 16:this.$=a[s].trim(),r.setAccTitle(this.$);break;case 17:case 18:this.$=a[s].trim(),r.setAccDescription(this.$);break;case 19:case 43:this.$=a[s];break;case 20:case 41:case 42:this.$=a[s].replace(/"/g,``);break;case 21:case 29:this.$=[a[s]];break;case 22:a[s].push(a[s-1]),this.$=a[s];break;case 23:this.$={attributeType:a[s-1],attributeName:a[s]};break;case 24:this.$={attributeType:a[s-2],attributeName:a[s-1],attributeKeyTypeList:a[s]};break;case 25:this.$={attributeType:a[s-2],attributeName:a[s-1],attributeComment:a[s]};break;case 26:this.$={attributeType:a[s-3],attributeName:a[s-2],attributeKeyTypeList:a[s-1],attributeComment:a[s]};break;case 27:case 28:case 31:this.$=a[s];break;case 30:a[s-2].push(a[s]),this.$=a[s-2];break;case 32:this.$=a[s].replace(/"/g,``);break;case 33:this.$={cardA:a[s],relType:a[s-1],cardB:a[s-2]};break;case 34:this.$=r.Cardinality.ZERO_OR_ONE;break;case 35:this.$=r.Cardinality.ZERO_OR_MORE;break;case 36:this.$=r.Cardinality.ONE_OR_MORE;break;case 37:this.$=r.Cardinality.ONLY_ONE;break;case 38:this.$=r.Cardinality.MD_PARENT;break;case 39:this.$=r.Identification.NON_IDENTIFYING;break;case 40:this.$=r.Identification.IDENTIFYING;break}},table:[{3:1,4:[1,2]},{1:[3]},e(t,[2,2],{5:3}),{6:[1,4],7:5,8:[1,6],9:7,10:[1,8],11:9,20:n,22:r,24:i,26:a,27:o,28:s},e(t,[2,7],{1:[2,1]}),e(t,[2,3]),{9:16,11:9,20:n,22:r,24:i,26:a,27:o,28:s},e(t,[2,5]),e(t,[2,6]),e(t,[2,11],{12:17,39:20,15:[1,18],18:[1,19],41:c,42:l,43:u,44:d,45:f}),{21:[1,26]},{23:[1,27]},{25:[1,28]},e(t,[2,18]),e(p,[2,19]),e(p,[2,20]),e(t,[2,4]),{11:29,27:o,28:s},{16:30,17:[1,31],29:32,30:33,34:m},{11:35,27:o,28:s},{40:36,46:[1,37],47:[1,38]},e(h,[2,34]),e(h,[2,35]),e(h,[2,36]),e(h,[2,37]),e(h,[2,38]),e(t,[2,15]),e(t,[2,16]),e(t,[2,17]),{13:[1,39]},{17:[1,40]},e(t,[2,10]),{16:41,17:[2,21],29:32,30:33,34:m},{31:42,34:[1,43]},{34:[2,27]},{19:[1,44]},{39:45,41:c,42:l,43:u,44:d,45:f},e(g,[2,39]),e(g,[2,40]),{14:46,27:[1,49],28:[1,48],48:[1,47]},e(t,[2,9]),{17:[2,22]},e(_,[2,23],{32:50,33:51,35:52,37:v,38:y}),e([17,34,37,38],[2,28]),e(t,[2,14],{15:[1,55]}),e([27,28],[2,33]),e(t,[2,8]),e(t,[2,41]),e(t,[2,42]),e(t,[2,43]),e(_,[2,24],{33:56,36:[1,57],38:y}),e(_,[2,25]),e(b,[2,29]),e(_,[2,32]),e(b,[2,31]),{16:58,17:[1,59],29:32,30:33,34:m},e(_,[2,26]),{35:60,37:v},{17:[1,61]},e(t,[2,13]),e(b,[2,30]),e(t,[2,12])],defaultActions:{34:[2,27],41:[2,22]},parseError:function(e,t){if(t.recoverable)this.trace(e);else{var n=Error(e);throw n.hash=t,n}},parse:function(e){var t=this,n=[0],r=[],i=[null],a=[],o=this.table,s=``,c=0,l=0,u=2,d=1,f=a.slice.call(arguments,1),p=Object.create(this.lexer),m={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(m.yy[h]=this.yy[h]);p.setInput(e,m.yy),m.yy.lexer=p,m.yy.parser=this,p.yylloc===void 0&&(p.yylloc={});var g=p.yylloc;a.push(g);var _=p.options&&p.options.ranges;typeof m.yy.parseError==`function`?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function v(){var e=r.pop()||p.lex()||d;return typeof e!=`number`&&(e instanceof Array&&(r=e,e=r.pop()),e=t.symbols_[e]||e),e}for(var y,b,x,S,C={},w,T,E,D;;){if(b=n[n.length-1],this.defaultActions[b]?x=this.defaultActions[b]:(y??=v(),x=o[b]&&o[b][y]),x===void 0||!x.length||!x[0]){var O=``;for(w in D=[],o[b])this.terminals_[w]&&w>u&&D.push(`'`+this.terminals_[w]+`'`);O=p.showPosition?`Parse error on line `+(c+1)+`:
`+p.showPosition()+`
Expecting `+D.join(`, `)+`, got '`+(this.terminals_[y]||y)+`'`:`Parse error on line `+(c+1)+`: Unexpected `+(y==d?`end of input`:`'`+(this.terminals_[y]||y)+`'`),this.parseError(O,{text:p.match,token:this.terminals_[y]||y,line:p.yylineno,loc:g,expected:D})}if(x[0]instanceof Array&&x.length>1)throw Error(`Parse Error: multiple actions possible at state: `+b+`, token: `+y);switch(x[0]){case 1:n.push(y),i.push(p.yytext),a.push(p.yylloc),n.push(x[1]),y=null,l=p.yyleng,s=p.yytext,c=p.yylineno,g=p.yylloc;break;case 2:if(T=this.productions_[x[1]][1],C.$=i[i.length-T],C._$={first_line:a[a.length-(T||1)].first_line,last_line:a[a.length-1].last_line,first_column:a[a.length-(T||1)].first_column,last_column:a[a.length-1].last_column},_&&(C._$.range=[a[a.length-(T||1)].range[0],a[a.length-1].range[1]]),S=this.performAction.apply(C,[s,l,c,m.yy,x[1],i,a].concat(f)),S!==void 0)return S;T&&(n=n.slice(0,-1*T*2),i=i.slice(0,-1*T),a=a.slice(0,-1*T)),n.push(this.productions_[x[1]][0]),i.push(C.$),a.push(C._$),E=o[n[n.length-2]][n[n.length-1]],n.push(E);break;case 3:return!0}}return!0}};x.lexer=function(){return{EOF:1,parseError:function(e,t){if(this.yy.parser)this.yy.parser.parseError(e,t);else throw Error(e)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match=``,this.conditionStack=[`INITIAL`],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError(`Lexical error on line `+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:``,token:null,line:this.yylineno});return this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?`...`:``)+e.substr(-20).replace(/\n/g,``)},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?`...`:``)).replace(/\n/g,``)},showPosition:function(){var e=this.pastInput(),t=Array(e.length+1).join(`-`);return e+this.upcomingInput()+`
`+t+`^`},test_match:function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext=``,this.match=``);for(var i=this._currentRules(),a=0;a<i.length;a++)if(n=this._input.match(this.rules[i[a]]),n&&(!t||n[0].length>t[0].length)){if(t=n,r=a,this.options.backtrack_lexer){if(e=this.test_match(n,i[a]),e!==!1)return e;if(this._backtrack){t=!1;continue}else return!1}else if(!this.options.flex)break}return t?(e=this.test_match(t,i[r]),e===!1?!1:e):this._input===``?this.EOF:this.parseError(`Lexical error on line `+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:``,token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:`INITIAL`},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{"case-insensitive":!0},performAction:function(e,t,n,r){switch(n){case 0:return this.begin(`acc_title`),22;case 1:return this.popState(),`acc_title_value`;case 2:return this.begin(`acc_descr`),24;case 3:return this.popState(),`acc_descr_value`;case 4:this.begin(`acc_descr_multiline`);break;case 5:this.popState();break;case 6:return`acc_descr_multiline_value`;case 7:return 10;case 8:break;case 9:return 8;case 10:return 28;case 11:return 48;case 12:return 4;case 13:return this.begin(`block`),15;case 14:return 36;case 15:break;case 16:return 37;case 17:return 34;case 18:return 34;case 19:return 38;case 20:break;case 21:return this.popState(),17;case 22:return t.yytext[0];case 23:return 18;case 24:return 19;case 25:return 41;case 26:return 43;case 27:return 43;case 28:return 43;case 29:return 41;case 30:return 41;case 31:return 42;case 32:return 42;case 33:return 42;case 34:return 42;case 35:return 42;case 36:return 43;case 37:return 42;case 38:return 43;case 39:return 44;case 40:return 44;case 41:return 44;case 42:return 44;case 43:return 41;case 44:return 42;case 45:return 43;case 46:return 45;case 47:return 46;case 48:return 47;case 49:return 47;case 50:return 46;case 51:return 46;case 52:return 46;case 53:return 27;case 54:return t.yytext[0];case 55:return 6}},rules:[/^(?:accTitle\s*:\s*)/i,/^(?:(?!\n||)*[^\n]*)/i,/^(?:accDescr\s*:\s*)/i,/^(?:(?!\n||)*[^\n]*)/i,/^(?:accDescr\s*\{\s*)/i,/^(?:[\}])/i,/^(?:[^\}]*)/i,/^(?:[\n]+)/i,/^(?:\s+)/i,/^(?:[\s]+)/i,/^(?:"[^"%\r\n\v\b\\]+")/i,/^(?:"[^"]*")/i,/^(?:erDiagram\b)/i,/^(?:\{)/i,/^(?:,)/i,/^(?:\s+)/i,/^(?:\b((?:PK)|(?:FK)|(?:UK))\b)/i,/^(?:(.*?)[~](.*?)*[~])/i,/^(?:[\*A-Za-z_][A-Za-z0-9\-_\[\]\(\)]*)/i,/^(?:"[^"]*")/i,/^(?:[\n]+)/i,/^(?:\})/i,/^(?:.)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:one or zero\b)/i,/^(?:one or more\b)/i,/^(?:one or many\b)/i,/^(?:1\+)/i,/^(?:\|o\b)/i,/^(?:zero or one\b)/i,/^(?:zero or more\b)/i,/^(?:zero or many\b)/i,/^(?:0\+)/i,/^(?:\}o\b)/i,/^(?:many\(0\))/i,/^(?:many\(1\))/i,/^(?:many\b)/i,/^(?:\}\|)/i,/^(?:one\b)/i,/^(?:only one\b)/i,/^(?:1\b)/i,/^(?:\|\|)/i,/^(?:o\|)/i,/^(?:o\{)/i,/^(?:\|\{)/i,/^(?:\s*u\b)/i,/^(?:\.\.)/i,/^(?:--)/i,/^(?:to\b)/i,/^(?:optionally to\b)/i,/^(?:\.-)/i,/^(?:-\.)/i,/^(?:[A-Za-z_][A-Za-z0-9\-_]*)/i,/^(?:.)/i,/^(?:$)/i],conditions:{acc_descr_multiline:{rules:[5,6],inclusive:!1},acc_descr:{rules:[3],inclusive:!1},acc_title:{rules:[1],inclusive:!1},block:{rules:[14,15,16,17,18,19,20,21,22],inclusive:!1},INITIAL:{rules:[0,2,4,7,8,9,10,11,12,13,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],inclusive:!0}}}}();function S(){this.yy={}}return S.prototype=x,x.Parser=S,new S}();N.parser=N;var P=N,F={},I=[],L={ZERO_OR_ONE:`ZERO_OR_ONE`,ZERO_OR_MORE:`ZERO_OR_MORE`,ONE_OR_MORE:`ONE_OR_MORE`,ONLY_ONE:`ONLY_ONE`,MD_PARENT:`MD_PARENT`},R={NON_IDENTIFYING:`NON_IDENTIFYING`,IDENTIFYING:`IDENTIFYING`},z=function(e,t=void 0){return F[e]===void 0?(F[e]={attributes:[],alias:t},i.info(`Added new entity :`,e)):F[e]&&!F[e].alias&&t&&(F[e].alias=t,i.info(`Add alias '${t}' to entity '${e}'`)),F[e]},B={Cardinality:L,Identification:R,getConfig:()=>_().er,addEntity:z,addAttributes:function(e,t){let n=z(e),r;for(r=t.length-1;r>=0;r--)n.attributes.push(t[r]),i.debug(`Added attribute `,t[r].attributeName)},getEntities:()=>F,addRelationship:function(e,t,n,r){let a={entityA:e,roleA:t,entityB:n,relSpec:r};I.push(a),i.debug(`Added new relationship :`,a)},getRelationships:()=>I,clear:function(){F={},I=[],m()},setAccTitle:a,getAccTitle:u,setAccDescription:c,getAccDescription:f,setDiagramTitle:s,getDiagramTitle:d},V={ONLY_ONE_START:`ONLY_ONE_START`,ONLY_ONE_END:`ONLY_ONE_END`,ZERO_OR_ONE_START:`ZERO_OR_ONE_START`,ZERO_OR_ONE_END:`ZERO_OR_ONE_END`,ONE_OR_MORE_START:`ONE_OR_MORE_START`,ONE_OR_MORE_END:`ONE_OR_MORE_END`,ZERO_OR_MORE_START:`ZERO_OR_MORE_START`,ZERO_OR_MORE_END:`ZERO_OR_MORE_END`,MD_PARENT_END:`MD_PARENT_END`,MD_PARENT_START:`MD_PARENT_START`},H={ERMarkers:V,insertMarkers:function(e,t){let n;e.append(`defs`).append(`marker`).attr(`id`,V.MD_PARENT_START).attr(`refX`,0).attr(`refY`,7).attr(`markerWidth`,190).attr(`markerHeight`,240).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,V.MD_PARENT_END).attr(`refX`,19).attr(`refY`,7).attr(`markerWidth`,20).attr(`markerHeight`,28).attr(`orient`,`auto`).append(`path`).attr(`d`,`M 18,7 L9,13 L1,7 L9,1 Z`),e.append(`defs`).append(`marker`).attr(`id`,V.ONLY_ONE_START).attr(`refX`,0).attr(`refY`,9).attr(`markerWidth`,18).attr(`markerHeight`,18).attr(`orient`,`auto`).append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M9,0 L9,18 M15,0 L15,18`),e.append(`defs`).append(`marker`).attr(`id`,V.ONLY_ONE_END).attr(`refX`,18).attr(`refY`,9).attr(`markerWidth`,18).attr(`markerHeight`,18).attr(`orient`,`auto`).append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M3,0 L3,18 M9,0 L9,18`),n=e.append(`defs`).append(`marker`).attr(`id`,V.ZERO_OR_ONE_START).attr(`refX`,0).attr(`refY`,9).attr(`markerWidth`,30).attr(`markerHeight`,18).attr(`orient`,`auto`),n.append(`circle`).attr(`stroke`,t.stroke).attr(`fill`,`white`).attr(`cx`,21).attr(`cy`,9).attr(`r`,6),n.append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M9,0 L9,18`),n=e.append(`defs`).append(`marker`).attr(`id`,V.ZERO_OR_ONE_END).attr(`refX`,30).attr(`refY`,9).attr(`markerWidth`,30).attr(`markerHeight`,18).attr(`orient`,`auto`),n.append(`circle`).attr(`stroke`,t.stroke).attr(`fill`,`white`).attr(`cx`,9).attr(`cy`,9).attr(`r`,6),n.append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M21,0 L21,18`),e.append(`defs`).append(`marker`).attr(`id`,V.ONE_OR_MORE_START).attr(`refX`,18).attr(`refY`,18).attr(`markerWidth`,45).attr(`markerHeight`,36).attr(`orient`,`auto`).append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27`),e.append(`defs`).append(`marker`).attr(`id`,V.ONE_OR_MORE_END).attr(`refX`,27).attr(`refY`,18).attr(`markerWidth`,45).attr(`markerHeight`,36).attr(`orient`,`auto`).append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18`),n=e.append(`defs`).append(`marker`).attr(`id`,V.ZERO_OR_MORE_START).attr(`refX`,18).attr(`refY`,18).attr(`markerWidth`,57).attr(`markerHeight`,36).attr(`orient`,`auto`),n.append(`circle`).attr(`stroke`,t.stroke).attr(`fill`,`white`).attr(`cx`,48).attr(`cy`,18).attr(`r`,6),n.append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M0,18 Q18,0 36,18 Q18,36 0,18`),n=e.append(`defs`).append(`marker`).attr(`id`,V.ZERO_OR_MORE_END).attr(`refX`,39).attr(`refY`,18).attr(`markerWidth`,57).attr(`markerHeight`,36).attr(`orient`,`auto`),n.append(`circle`).attr(`stroke`,t.stroke).attr(`fill`,`white`).attr(`cx`,9).attr(`cy`,18).attr(`r`,6),n.append(`path`).attr(`stroke`,t.stroke).attr(`fill`,`none`).attr(`d`,`M21,18 Q39,0 57,18 Q39,36 21,18`)}},U=/[^\dA-Za-z](\W)*/g,W={},G=new Map,K=function(e){let t=Object.keys(e);for(let n of t)W[n]=e[n]},q=(e,t,n)=>{let r=W.entityPadding/3,i=W.entityPadding/3,a=W.fontSize*.85,o=t.node().getBBox(),s=[],c=!1,l=!1,u=0,d=0,f=0,m=0,h=o.height+r*2,g=1;n.forEach(e=>{e.attributeKeyTypeList!==void 0&&e.attributeKeyTypeList.length>0&&(c=!0),e.attributeComment!==void 0&&(l=!0)}),n.forEach(n=>{let i=`${t.node().id}-attr-${g}`,o=0,v=p(n.attributeType),y=e.append(`text`).classed(`er entityLabel`,!0).attr(`id`,`${i}-type`).attr(`x`,0).attr(`y`,0).style(`dominant-baseline`,`middle`).style(`text-anchor`,`left`).style(`font-family`,_().fontFamily).style(`font-size`,a+`px`).text(v),b=e.append(`text`).classed(`er entityLabel`,!0).attr(`id`,`${i}-name`).attr(`x`,0).attr(`y`,0).style(`dominant-baseline`,`middle`).style(`text-anchor`,`left`).style(`font-family`,_().fontFamily).style(`font-size`,a+`px`).text(n.attributeName),x={};x.tn=y,x.nn=b;let S=y.node().getBBox(),C=b.node().getBBox();if(u=Math.max(u,S.width),d=Math.max(d,C.width),o=Math.max(S.height,C.height),c){let t=n.attributeKeyTypeList===void 0?``:n.attributeKeyTypeList.join(`,`),r=e.append(`text`).classed(`er entityLabel`,!0).attr(`id`,`${i}-key`).attr(`x`,0).attr(`y`,0).style(`dominant-baseline`,`middle`).style(`text-anchor`,`left`).style(`font-family`,_().fontFamily).style(`font-size`,a+`px`).text(t);x.kn=r;let s=r.node().getBBox();f=Math.max(f,s.width),o=Math.max(o,s.height)}if(l){let t=e.append(`text`).classed(`er entityLabel`,!0).attr(`id`,`${i}-comment`).attr(`x`,0).attr(`y`,0).style(`dominant-baseline`,`middle`).style(`text-anchor`,`left`).style(`font-family`,_().fontFamily).style(`font-size`,a+`px`).text(n.attributeComment||``);x.cn=t;let r=t.node().getBBox();m=Math.max(m,r.width),o=Math.max(o,r.height)}x.height=o,s.push(x),h+=o+r*2,g+=1});let v=4;c&&(v+=2),l&&(v+=2);let y=u+d+f+m,b={width:Math.max(W.minEntityWidth,Math.max(o.width+W.entityPadding*2,y+i*v)),height:n.length>0?h:Math.max(W.minEntityHeight,o.height+W.entityPadding*2)};if(n.length>0){let n=Math.max(0,(b.width-y-i*v)/(v/2));t.attr(`transform`,`translate(`+b.width/2+`,`+(r+o.height/2)+`)`);let a=o.height+r*2,p=`attributeBoxOdd`;s.forEach(t=>{let o=a+r+t.height/2;t.tn.attr(`transform`,`translate(`+i+`,`+o+`)`);let s=e.insert(`rect`,`#`+t.tn.node().id).classed(`er ${p}`,!0).attr(`x`,0).attr(`y`,a).attr(`width`,u+i*2+n).attr(`height`,t.height+r*2),h=parseFloat(s.attr(`x`))+parseFloat(s.attr(`width`));t.nn.attr(`transform`,`translate(`+(h+i)+`,`+o+`)`);let g=e.insert(`rect`,`#`+t.nn.node().id).classed(`er ${p}`,!0).attr(`x`,h).attr(`y`,a).attr(`width`,d+i*2+n).attr(`height`,t.height+r*2),_=parseFloat(g.attr(`x`))+parseFloat(g.attr(`width`));if(c){t.kn.attr(`transform`,`translate(`+(_+i)+`,`+o+`)`);let s=e.insert(`rect`,`#`+t.kn.node().id).classed(`er ${p}`,!0).attr(`x`,_).attr(`y`,a).attr(`width`,f+i*2+n).attr(`height`,t.height+r*2);_=parseFloat(s.attr(`x`))+parseFloat(s.attr(`width`))}l&&(t.cn.attr(`transform`,`translate(`+(_+i)+`,`+o+`)`),e.insert(`rect`,`#`+t.cn.node().id).classed(`er ${p}`,`true`).attr(`x`,_).attr(`y`,a).attr(`width`,m+i*2+n).attr(`height`,t.height+r*2)),a+=t.height+r*2,p=p===`attributeBoxOdd`?`attributeBoxEven`:`attributeBoxOdd`})}else b.height=Math.max(W.minEntityHeight,h),t.attr(`transform`,`translate(`+b.width/2+`,`+b.height/2+`)`);return b},J=function(e,t,n){let r=Object.keys(t),i;return r.forEach(function(r){let a=re(r,`entity`);G.set(r,a);let o=e.append(`g`).attr(`id`,a);i=i===void 0?a:i;let s=`text-`+a,{width:c,height:l}=q(o,o.append(`text`).classed(`er entityLabel`,!0).attr(`id`,s).attr(`x`,0).attr(`y`,0).style(`dominant-baseline`,`middle`).style(`text-anchor`,`middle`).style(`font-family`,_().fontFamily).style(`font-size`,W.fontSize+`px`).text(t[r].alias??r),t[r].attributes),u=o.insert(`rect`,`#`+s).classed(`er entityBox`,!0).attr(`x`,0).attr(`y`,0).attr(`width`,c).attr(`height`,l).node().getBBox();n.setNode(a,{width:u.width,height:u.height,shape:`rect`,id:a})}),i},Y=function(e,t){t.nodes().forEach(function(n){n!==void 0&&t.node(n)!==void 0&&e.select(`#`+n).attr(`transform`,`translate(`+(t.node(n).x-t.node(n).width/2)+`,`+(t.node(n).y-t.node(n).height/2)+` )`)})},X=function(e){return(e.entityA+e.roleA+e.entityB).replace(/\s/g,``)},Z=function(e,t){return e.forEach(function(e){t.setEdge(G.get(e.entityA),G.get(e.entityB),{relationship:e},X(e))}),e},Q=0,ee=function(e,t,n,r,i){Q++;let a=n.edge(G.get(t.entityA),G.get(t.entityB),X(t)),o=y().x(function(e){return e.x}).y(function(e){return e.y}).curve(l),s=e.insert(`path`,`#`+r).classed(`er relationshipLine`,!0).attr(`d`,o(a.points)).style(`stroke`,W.stroke).style(`fill`,`none`);t.relSpec.relType===i.db.Identification.NON_IDENTIFYING&&s.attr(`stroke-dasharray`,`8,8`);let c=``;switch(W.arrowMarkerAbsolute&&(c=window.location.protocol+`//`+window.location.host+window.location.pathname+window.location.search,c=c.replace(/\(/g,`\\(`),c=c.replace(/\)/g,`\\)`)),t.relSpec.cardA){case i.db.Cardinality.ZERO_OR_ONE:s.attr(`marker-end`,`url(`+c+`#`+H.ERMarkers.ZERO_OR_ONE_END+`)`);break;case i.db.Cardinality.ZERO_OR_MORE:s.attr(`marker-end`,`url(`+c+`#`+H.ERMarkers.ZERO_OR_MORE_END+`)`);break;case i.db.Cardinality.ONE_OR_MORE:s.attr(`marker-end`,`url(`+c+`#`+H.ERMarkers.ONE_OR_MORE_END+`)`);break;case i.db.Cardinality.ONLY_ONE:s.attr(`marker-end`,`url(`+c+`#`+H.ERMarkers.ONLY_ONE_END+`)`);break;case i.db.Cardinality.MD_PARENT:s.attr(`marker-end`,`url(`+c+`#`+H.ERMarkers.MD_PARENT_END+`)`);break}switch(t.relSpec.cardB){case i.db.Cardinality.ZERO_OR_ONE:s.attr(`marker-start`,`url(`+c+`#`+H.ERMarkers.ZERO_OR_ONE_START+`)`);break;case i.db.Cardinality.ZERO_OR_MORE:s.attr(`marker-start`,`url(`+c+`#`+H.ERMarkers.ZERO_OR_MORE_START+`)`);break;case i.db.Cardinality.ONE_OR_MORE:s.attr(`marker-start`,`url(`+c+`#`+H.ERMarkers.ONE_OR_MORE_START+`)`);break;case i.db.Cardinality.ONLY_ONE:s.attr(`marker-start`,`url(`+c+`#`+H.ERMarkers.ONLY_ONE_START+`)`);break;case i.db.Cardinality.MD_PARENT:s.attr(`marker-start`,`url(`+c+`#`+H.ERMarkers.MD_PARENT_START+`)`);break}let u=s.node().getTotalLength(),d=s.node().getPointAtLength(u*.5),f=`rel`+Q,p=e.append(`text`).classed(`er relationshipLabel`,!0).attr(`id`,f).attr(`x`,d.x).attr(`y`,d.y).style(`text-anchor`,`middle`).style(`dominant-baseline`,`middle`).style(`font-family`,_().fontFamily).style(`font-size`,W.fontSize+`px`).text(t.roleA).node().getBBox();e.insert(`rect`,`#`+f).classed(`er relationshipLabelBox`,!0).attr(`x`,d.x-p.width/2).attr(`y`,d.y-p.height/2).attr(`width`,p.width).attr(`height`,p.height)},te=function(e,a,o,s){W=_().er,i.info(`Drawing ER diagram`);let c=_().securityLevel,l;c===`sandbox`&&(l=v(`#i`+a));let u=v(c===`sandbox`?l.nodes()[0].contentDocument.body:`body`).select(`[id='${a}']`);H.insertMarkers(u,W);let d;d=new t({multigraph:!0,directed:!0,compound:!1}).setGraph({rankdir:W.layoutDirection,marginx:20,marginy:20,nodesep:100,edgesep:100,ranksep:100}).setDefaultEdgeLabel(function(){return{}});let f=J(u,s.db.getEntities(),d),p=Z(s.db.getRelationships(),d);n(d),Y(u,d),p.forEach(function(e){ee(u,e,d,f,s)});let m=W.diagramPadding;r.insertTitle(u,`entityTitleText`,W.titleTopMargin,s.db.getDiagramTitle());let g=u.node().getBBox(),y=g.width+m*2,b=g.height+m*2;h(u,b,y,W.useMaxWidth),u.attr(`viewBox`,`${g.x-m} ${g.y-m} ${y} ${b}`)},ne=`28e9f9db-3c8d-5aa5-9faf-44286ae5937c`;function re(e=``,t=``){let n=e.replace(U,``);return`${$(t)}${$(n)}${M(e,ne)}`}function $(e=``){return e.length>0?`${e}-`:``}var ie={parser:P,db:B,renderer:{setConf:K,draw:te},styles:e=>`
  .entityBox {
    fill: ${e.mainBkg};
    stroke: ${e.nodeBorder};
  }

  .attributeBoxOdd {
    fill: ${e.attributeBackgroundColorOdd};
    stroke: ${e.nodeBorder};
  }

  .attributeBoxEven {
    fill:  ${e.attributeBackgroundColorEven};
    stroke: ${e.nodeBorder};
  }

  .relationshipLabelBox {
    fill: ${e.tertiaryColor};
    opacity: 0.7;
    background-color: ${e.tertiaryColor};
      rect {
        opacity: 0.5;
      }
  }

    .relationshipLine {
      stroke: ${e.lineColor};
    }

  .entityTitleText {
    text-anchor: middle;
    font-size: 18px;
    fill: ${e.textColor};
  }    
  #MD_PARENT_START {
    fill: #f5f5f5 !important;
    stroke: ${e.lineColor} !important;
    stroke-width: 1;
  }
  #MD_PARENT_END {
    fill: #f5f5f5 !important;
    stroke: ${e.lineColor} !important;
    stroke-width: 1;
  }
  
`};export{ie as diagram};